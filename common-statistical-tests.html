<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans" xml:lang="zh-Hans"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>R 语言数据分析实战 - 19&nbsp; 常见的统计检验</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./regression-and-correlation.html" rel="next">
<link href="./documents-office.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交",
    "search-label": "搜索"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZPWJBMKFL8"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-ZPWJBMKFL8', { 'anonymize_ip': true});
</script><script>
MathJax ={
  tex: {
    macros: {
      bm: ["{\\boldsymbol #1}",1],
    }
  }
};
</script><script src="site_libs/quarto-diagram/mermaid.min.js"></script><script src="site_libs/quarto-diagram/mermaid-init.js"></script><link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./common-statistical-tests.html">统计分析</a></li><li class="breadcrumb-item"><a href="./common-statistical-tests.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">常见的统计检验</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="切换侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R 语言数据分析实战</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/XiangyunHuang/data-analysis-in-action" title="源代码" class="quarto-navigation-tool px-1" aria-label="源代码"><i class="bi bi-github"></i></a>
    <a href="./_main.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="切换深色模式"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="搜索"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">欢迎</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">介绍</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">数据准备</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling-objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">数据对象</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling-collection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">数据获取</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling-cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">数据清洗</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling-manipulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">数据操作</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wrangling-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">数据处理</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">数据探索</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ggplot2 入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">基础图形</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">统计图形</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-lattice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">lattice 入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">graphics 入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-tikz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">TikZ 入门</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">探索实践</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">数据交流</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">交互图形</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">交互表格</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive-applications.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">交互应用</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./documents-html.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">HTML 文档</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./documents-latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">PDF 文档</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./documents-office.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Office 文档</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">统计分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./common-statistical-tests.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">常见的统计检验</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-and-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">回归与相关分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./categorical-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">分类数据的分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">统计检验的功效</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">数据建模</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze-network-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">网络数据分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze-text-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">文本数据分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze-survival-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">生存数据分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze-time-series-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">时序数据分析</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">空间分析</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze-point-pattern.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">点模式数据分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">点参考数据分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analyze-areal-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">区域数据分析</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">优化建模</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistical-computation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">统计计算</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numerical-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">数值优化</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./optimization-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">优化问题</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">贝叶斯建模</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probabilistic-reasoning-framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">概率推理框架</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-linear-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">广义线性模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hierarchical-normal-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">分层正态模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mixed-effects-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">混合效应模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-additive-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">广义可加模型</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gaussian-processes-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">高斯过程回归</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-series-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">时间序列回归</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">机器学习</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">分类问题</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">聚类问题</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">回归问题</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true">
 <span class="menu-text">附录</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="切換部分">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">数学符号</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrix-operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">矩阵运算</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./git-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Git 和 Github</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">目录</h2>
   
  <ul>
<li>
<a href="#sec-one-sample" id="toc-sec-one-sample" class="nav-link active" data-scroll-target="#sec-one-sample"><span class="header-section-number">19.1</span> 单样本检验</a>
  <ul class="collapse">
<li><a href="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C" id="toc-正态总体均值检验" class="nav-link" data-scroll-target="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C"><span class="header-section-number">19.1.1</span> 正态总体均值检验</a></li>
  <li><a href="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C" id="toc-正态总体方差检验" class="nav-link" data-scroll-target="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C"><span class="header-section-number">19.1.2</span> 正态总体方差检验</a></li>
  <li><a href="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C" id="toc-总体未知均值检验" class="nav-link" data-scroll-target="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C"><span class="header-section-number">19.1.3</span> 总体未知均值检验</a></li>
  <li><a href="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C" id="toc-总体未知方差检验" class="nav-link" data-scroll-target="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C"><span class="header-section-number">19.1.4</span> 总体未知方差检验</a></li>
  </ul>
</li>
  <li>
<a href="#sec-two-samples" id="toc-sec-two-samples" class="nav-link" data-scroll-target="#sec-two-samples"><span class="header-section-number">19.2</span> 两样本检验</a>
  <ul class="collapse">
<li><a href="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-1" id="toc-正态总体均值检验-1" class="nav-link" data-scroll-target="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">19.2.1</span> 正态总体均值检验</a></li>
  <li><a href="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-1" id="toc-正态总体方差检验-1" class="nav-link" data-scroll-target="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">19.2.2</span> 正态总体方差检验</a></li>
  <li><a href="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-1" id="toc-总体未知均值检验-1" class="nav-link" data-scroll-target="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">19.2.3</span> 总体未知均值检验</a></li>
  <li><a href="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-1" id="toc-总体未知方差检验-1" class="nav-link" data-scroll-target="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">19.2.4</span> 总体未知方差检验</a></li>
  </ul>
</li>
  <li>
<a href="#sec-multi-samples" id="toc-sec-multi-samples" class="nav-link" data-scroll-target="#sec-multi-samples"><span class="header-section-number">19.3</span> 多样本检验</a>
  <ul class="collapse">
<li><a href="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-2" id="toc-正态总体均值检验-2" class="nav-link" data-scroll-target="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-2"><span class="header-section-number">19.3.1</span> 正态总体均值检验</a></li>
  <li><a href="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-2" id="toc-正态总体方差检验-2" class="nav-link" data-scroll-target="#%E6%AD%A3%E6%80%81%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-2"><span class="header-section-number">19.3.2</span> 正态总体方差检验</a></li>
  <li><a href="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-2" id="toc-总体未知均值检验-2" class="nav-link" data-scroll-target="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E5%9D%87%E5%80%BC%E6%A3%80%E9%AA%8C-2"><span class="header-section-number">19.3.3</span> 总体未知均值检验</a></li>
  <li><a href="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-2" id="toc-总体未知方差检验-2" class="nav-link" data-scroll-target="#%E6%80%BB%E4%BD%93%E6%9C%AA%E7%9F%A5%E6%96%B9%E5%B7%AE%E6%A3%80%E9%AA%8C-2"><span class="header-section-number">19.3.4</span> 总体未知方差检验</a></li>
  </ul>
</li>
  <li>
<a href="#sec-pairwise-data" id="toc-sec-pairwise-data" class="nav-link" data-scroll-target="#sec-pairwise-data"><span class="header-section-number">19.4</span> 配对样本检验</a>
  <ul class="collapse">
<li><a href="#sec-paired-t-test" id="toc-sec-paired-t-test" class="nav-link" data-scroll-target="#sec-paired-t-test"><span class="header-section-number">19.4.1</span> 配对 t 检验</a></li>
  <li><a href="#sec-paired-wilcox-test" id="toc-sec-paired-wilcox-test" class="nav-link" data-scroll-target="#sec-paired-wilcox-test"><span class="header-section-number">19.4.2</span> 配对 Wilcoxon 检验</a></li>
  </ul>
</li>
  <li>
<a href="#sec-multiple-comparisons" id="toc-sec-multiple-comparisons" class="nav-link" data-scroll-target="#sec-multiple-comparisons"><span class="header-section-number">19.5</span> 多重假设检验</a>
  <ul class="collapse">
<li><a href="#%E5%A4%9A%E9%87%8D-t-%E6%A3%80%E9%AA%8C" id="toc-多重-t-检验" class="nav-link" data-scroll-target="#%E5%A4%9A%E9%87%8D-t-%E6%A3%80%E9%AA%8C"><span class="header-section-number">19.5.1</span> 多重 t 检验</a></li>
  <li><a href="#sec-pairwise-prop-test" id="toc-sec-pairwise-prop-test" class="nav-link" data-scroll-target="#sec-pairwise-prop-test"><span class="header-section-number">19.5.2</span> 多重比例检验</a></li>
  <li><a href="#sec-pairwise-wilcoxon-test" id="toc-sec-pairwise-wilcoxon-test" class="nav-link" data-scroll-target="#sec-pairwise-wilcoxon-test"><span class="header-section-number">19.5.3</span> Wilcoxon 检验</a></li>
  <li><a href="#dunn-%E6%A3%80%E9%AA%8C" id="toc-dunn-检验" class="nav-link" data-scroll-target="#dunn-%E6%A3%80%E9%AA%8C"><span class="header-section-number">19.5.4</span> Dunn 检验</a></li>
  </ul>
</li>
  <li>
<a href="#sec-distribution-test" id="toc-sec-distribution-test" class="nav-link" data-scroll-target="#sec-distribution-test"><span class="header-section-number">19.6</span> 总体分布的检验</a>
  <ul class="collapse">
<li><a href="#sec-normality-test" id="toc-sec-normality-test" class="nav-link" data-scroll-target="#sec-normality-test"><span class="header-section-number">19.6.1</span> 正态性检验</a></li>
  <li><a href="#sec-ks-test" id="toc-sec-ks-test" class="nav-link" data-scroll-target="#sec-ks-test"><span class="header-section-number">19.6.2</span> 同分布检验</a></li>
  <li><a href="#sec-cor-test" id="toc-sec-cor-test" class="nav-link" data-scroll-target="#sec-cor-test"><span class="header-section-number">19.6.3</span> 相关性检验</a></li>
  <li><a href="#sec-Box-test" id="toc-sec-Box-test" class="nav-link" data-scroll-target="#sec-Box-test"><span class="header-section-number">19.6.4</span> 独立性检验</a></li>
  <li><a href="#sec-PP-test" id="toc-sec-PP-test" class="nav-link" data-scroll-target="#sec-PP-test"><span class="header-section-number">19.6.5</span> 平稳性检验</a></li>
  </ul>
</li>
  <li>
<a href="#sec-multivariate-hypothesis-testing" id="toc-sec-multivariate-hypothesis-testing" class="nav-link" data-scroll-target="#sec-multivariate-hypothesis-testing"><span class="header-section-number">19.7</span> 多元分布情形</a>
  <ul class="collapse">
<li><a href="#sec-hotelling-test" id="toc-sec-hotelling-test" class="nav-link" data-scroll-target="#sec-hotelling-test"><span class="header-section-number">19.7.1</span> Hotelling T<sup>2</sup> 检验</a></li>
  <li><a href="#sec-mauchly-test" id="toc-sec-mauchly-test" class="nav-link" data-scroll-target="#sec-mauchly-test"><span class="header-section-number">19.7.2</span> Mauchly 球形检验</a></li>
  </ul>
</li>
  <li>
<a href="#sec-common-statistical-tests-notes" id="toc-sec-common-statistical-tests-notes" class="nav-link" data-scroll-target="#sec-common-statistical-tests-notes"><span class="header-section-number">19.8</span> 假设检验的一些注记</a>
  <ul class="collapse">
<li><a href="#sec-multiple-comparison" id="toc-sec-multiple-comparison" class="nav-link" data-scroll-target="#sec-multiple-comparison"><span class="header-section-number">19.8.1</span> 假设检验和多重比较的关系</a></li>
  <li><a href="#%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C%E5%92%8C%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E7%9A%84%E5%85%B3%E7%B3%BB" id="toc-假设检验和方差分析的关系" class="nav-link" data-scroll-target="#%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C%E5%92%8C%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="header-section-number">19.8.2</span> 假设检验和方差分析的关系</a></li>
  <li><a href="#sec-test-and-interval" id="toc-sec-test-and-interval" class="nav-link" data-scroll-target="#sec-test-and-interval"><span class="header-section-number">19.8.3</span> 假设检验与区间估计的关系</a></li>
  <li><a href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%9F%E8%AE%A1%E6%A3%80%E9%AA%8C%E6%98%AF%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B" id="toc-常见的统计检验是线性模型" class="nav-link" data-scroll-target="#%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%9F%E8%AE%A1%E6%A3%80%E9%AA%8C%E6%98%AF%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B"><span class="header-section-number">19.8.4</span> 常见的统计检验是线性模型</a></li>
  <li><a href="#sec-industrial-application" id="toc-sec-industrial-application" class="nav-link" data-scroll-target="#sec-industrial-application"><span class="header-section-number">19.8.5</span> 假设检验的工业应用</a></li>
  </ul>
</li>
  <li><a href="#sec-common-statistical-tests-exercise" id="toc-sec-common-statistical-tests-exercise" class="nav-link" data-scroll-target="#sec-common-statistical-tests-exercise"><span class="header-section-number">19.9</span> 习题</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/XiangyunHuang/data-analysis-in-action/blob/main/common-statistical-tests.qmd" class="toc-action"><i class="bi bi-github"></i>查看代码</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./common-statistical-tests.html">统计分析</a></li><li class="breadcrumb-item"><a href="./common-statistical-tests.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">常见的统计检验</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-common-statistical-tests" class="quarto-section-identifier"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">常见的统计检验</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p></p>
<div class="hidden">
<p><span class="math display">\[
\def\bm#1{{\boldsymbol #1}}
\]</span></p>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
本章亮点
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>比较全面地展示各类统计检验问题的 R 语言实现，其覆盖面之广，远超市面上同类 R 语言书籍。从连续数据到离散数据，从单样本到两样本，再到一般的多样本，触及最前沿的热门话题。</p></li>
<li><p>对每类统计检验问题都给出示例及 R 语言实现，涉及近 40 个统计检验方法。在组织结构上，本章按照数据情况对检验方法分类，方便读者根据手头的数据情况，快速从众多的方法中定位最合适的检验方法，符合从数据出发进行分析实战的要求。</p></li>
</ol>
</div>
</div>
<blockquote class="blockquote">
<p>The Earth is Round (<span class="math inline">\(p &lt; 0.05\)</span>)</p>
<p>— Jacob Cohen <span class="citation" data-cites="Cohen1994">(<a href="references.html#ref-Cohen1994" role="doc-biblioref">Cohen 1994</a>)</span></p>
</blockquote>
<p>Jacob Cohen 实际谈的是更加深刻的问题。开篇介绍为什么需要假设检验，做检验和不做检验有什么区别？R. A. Fisher 将抽样分布、参数估计和假设检验列为统计推断的三个中心内容，可见假设检验的重要地位。经过近百余年的发展，假设检验具有丰富的内容，可以从不同的角度对检验方法进行归类。</p>
<ul>
<li>检验方法归类：参数与非参数检验方法。</li>
<li>检验计算方式：近似 Approximate、精确 Extract、模拟 Simulation 和重抽样 Bootstrap 等方式。</li>
<li>检验对象归类：位置参数（均值）和尺度参数（方差）的检验。</li>
<li>检验总体数量归类：单总体、两个总体和多个总体。</li>
<li>检验总体分布归类：正态、二项、泊松、多项分布等。</li>
<li>检验总体维度归类：分一维、二维和多维的情形。</li>
<li>检验样本的数量：小样本 <span class="math inline">\(n &lt; 30\)</span> 和大样本 <span class="math inline">\(n \geq 30\)</span>。</li>
</ul>
<p><span class="math inline">\(\chi^2\)</span> 分布、t 分布和 F 分布作为最基础的三大抽样分布，分别是由 K. Pearson 卡尔·皮尔逊、W. S. Gosset 哥塞特、R. A. Fisher 费希尔提出，并以他们的名字命名的。在假设检验中，也有许多检验方法是以提出者的名字命名的。本来名字具有突出效果，由检验方法联系人物名称，可以帮助记忆，但如此之多，以至于很难一一记住。因此，本文也不按检验方法罗列，但是，推荐读者了解这些统计大师的工作和故事，相信会加深对这些检验方法的理解。关于检验方法，如有不明白的地方，可以查看维基百科词条。对每个检验问题，本章给出原假设和备择假设，检验统计量及其服从的分布，R 语言实现（自编或调用函数，如果调用函数，说明参数及其含义），不讲公式推导过程。</p>
<p>在 R 语言中，有大量的函数可以对样本数据做检验，每一个函数对应一个或多个检验问题。为了让读者根据手头数据可以快速地找到最合适的检验方法。单样本检验、两样本检验和多样本检验都只针对连续数据。计数数据检验针对离散数据，不区分总体数量。配对样本检验是两样本检验中的特殊情况，不分连续还是离散，不分两个样本还是多个样本，多个样本就是两两配对检验。前面都是关于某个特征统计量的检验，对分布的检验涉及样本点是否来自正态分布，样本点是否独立和平稳，样本点是否来自某一分布，两个样本是否来自相同分布等。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(pwr)         <span class="co"># 计算检验的功效和实验样本量</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(dunn.test)   <span class="co"># dunn.test</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(car)       <span class="co"># leveneTest 可替代 bartlett.test</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(coin)      <span class="co"># 补充更多的检验方法</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># library(multcomp)  # 多重比较</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># library(MKpower)   # power.welch.t.test</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># library(rstatix)   # 管道操作整合检验方法</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># library(pwrss)     # 常见检验的功效和样本量计算</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="sec-one-sample" class="level2" data-number="19.1"><h2 data-number="19.1" class="anchored" data-anchor-id="sec-one-sample">
<span class="header-section-number">19.1</span> 单样本检验</h2>
<div class="cell" data-fig-width="6.5" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-one-sample" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-one-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-one-sample">flowchart LR
  A(单样本) --&gt; B1(正态总体)
  A  --&gt; B2(总体未知)
  B1 --&gt; C1(均值检验)
  C1 --&gt; D1(方差已知) --&gt; E1(Z 检验)
  C1 --&gt; D2(方差未知) --&gt; E2(t 检验)
  B1 --&gt; C2(方差检验) --&gt; E3(卡方检验)
  B2 --&gt; C3(均值检验) --&gt; E4(Wilcoxon 秩和检验)
  B2 --&gt; C4(方差检验) --&gt; E5[无检验方法]
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-one-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.1: 单样本检验
</figcaption></figure>
</div>
</div>
</div>
<section id="正态总体均值检验" class="level3" data-number="19.1.1"><h3 data-number="19.1.1" class="anchored" data-anchor-id="正态总体均值检验">
<span class="header-section-number">19.1.1</span> 正态总体均值检验</h3>
<section id="方差已知" class="level4" data-number="19.1.1.1"><h4 data-number="19.1.1.1" class="anchored" data-anchor-id="方差已知">
<span class="header-section-number">19.1.1.1</span> 方差已知</h4>
<p><span class="math display">\[
\begin{aligned}
\mathrm{I}   \quad H_0: \mu - \mu_0 \leq 0 \quad vs. \quad H_1: \mu - \mu_0 &gt; 0 \\
\mathrm{II}  \quad H_0: \mu - \mu_0 \geq 0 \quad vs. \quad H_1: \mu - \mu_0 &lt; 0 \\
\mathrm{III} \quad H_0: \mu - \mu_0 = 0 \quad vs. \quad H_1: \mu - \mu_0 \neq 0
\end{aligned}
\]</span></p>
<p>设 <span class="math inline">\(x_1,\cdots,x_n\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu,\sigma^2)\)</span> 的样本，样本均值和方差分别</p>
<p><span class="math inline">\(\bar{x} = \frac{\sum_{i=1}^{n}x_i}{n}\)</span> ，<span class="math inline">\(s^2 = \frac{1}{n-1}\sum_{i=1}^{n}(x_i - \bar{x})^2\)</span></p>
<p>考虑到 <span class="math inline">\(\bar{x} \sim \mathcal{N}(\mu,\sigma^2 / n)\)</span> ，则检验统计量服从正态分布</p>
<p><span class="math display">\[
u = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}}
\]</span></p>
<p>假定 <span class="math inline">\(\mu_0 = 1\)</span> 对于检验问题 I 拒绝域 <span class="math inline">\(\{u \geq u_{1-\alpha}\}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">set.seed</span>(<span class="dv">20232023</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># 样本</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fl">1.8</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># 检验统计量</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>u <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># 临界值</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.644854</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># P 值</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="at">q =</span> u)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.005082465</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
重要
</div>
</div>
<div class="callout-body-container callout-body">
<p>随机变量 <span class="math inline">\(X\)</span> 服从标准正态分布，它的概率分布函数如下：</p>
<p><span class="math display">\[
P(X \leq u)= \phi(u) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{u}\mathrm{e}^{-t^2/2}\mathrm{dt}
\]</span></p>
<p>若已知概率 <span class="math inline">\(p = 0.95\)</span> ，则对应的下分位点可用函数 <code><a href="https://rdrr.io/r/stats/Normal.html">qnorm()</a></code> 计算。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.644854</code></pre>
</div>
</div>
</div>
</div>
</section><section id="方差未知" class="level4" data-number="19.1.1.2"><h4 data-number="19.1.1.2" class="anchored" data-anchor-id="方差未知">
<span class="header-section-number">19.1.1.2</span> 方差未知</h4>
<p><span class="math display">\[
\begin{aligned}
\mathrm{I}   \quad H_0: \mu - \mu_0 \leq 0 \quad vs. \quad H_1: \mu - \mu_0 &gt; 0 \\
\mathrm{II}  \quad H_0: \mu - \mu_0 \geq 0 \quad vs. \quad H_1: \mu - \mu_0 &lt; 0 \\
\mathrm{III} \quad H_0: \mu - \mu_0 = 0 \quad vs. \quad H_1: \mu - \mu_0 \neq 0
\end{aligned}
\]</span></p>
<p>考虑到</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{\bar{x} - \mu}{\sigma / \sqrt{n}} \sim \mathcal{N}(0,1) \\
&amp; \frac{(n-1)s^2}{\sigma^2} \sim \chi^2(n-1) \\
&amp; \mathsf{E}\{s^2\} = \sigma^2 \quad \mathsf{Var}\{s^2\} = \frac{2\sigma^4}{n-1}
\end{aligned}
\]</span></p>
<p>根据 t 分布的定义，检验统计量服从 t 分布，即 <span class="math inline">\(t \sim t(n-1)\)</span></p>
<p><span class="math display">\[
t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}}
\]</span></p>
<p>假定 <span class="math inline">\(\mu_0 = 1\)</span> 对于检验问题 I ，拒绝域 <span class="math inline">\(\{t \geq t_{1-\alpha}(n-1)\}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># 检验统计量</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>t0 <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">var</span>(x) <span class="sc">/</span> n)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># 临界值</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="fu">qt</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.729133</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># P 值</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="at">q =</span> t0, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.01569596</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注释
</div>
</div>
<div class="callout-body-container callout-body">
<p>英国统计学家 William Sealy Gosset (1876-1937) 于 1908 年在杂志 《Biometrics》 上以笔名 Student 发表论文《The Probable Error of a Mean》<span class="citation" data-cites="Gosset1908">(<a href="references.html#ref-Gosset1908" role="doc-biblioref">"Student" 1908</a>)</span>，论文中展示了独立同正态分布的样本 <span class="math inline">\(x_1, \ldots, x_n \stackrel{i.i.d}{\sim} \mathcal{N}(\mu,\sigma^2)\)</span> 的样本方差 <span class="math inline">\(s^2\)</span> 和样本标准差 <span class="math inline">\(s\)</span> 的抽样分布，根据均值和标准差不相关的性质导出 t 分布，宣告 t 分布的诞生，因其在小样本领域的突出贡献，W. S. Gosset 进入世纪名人录 <span class="citation" data-cites="Heyde2001">(<a href="references.html#ref-Heyde2001" role="doc-biblioref">Heyde 等 2001</a>)</span>。</p>
</div>
</div>
<div class="cell">
<div id="tbl-t-quantile" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-t-quantile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表格&nbsp;19.1: <span class="math inline">\(t\)</span> 分布的分位数表
</figcaption><div aria-describedby="tbl-t-quantile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0.75</th>
<th style="text-align: right;">0.8</th>
<th style="text-align: right;">0.9</th>
<th style="text-align: right;">0.95</th>
<th style="text-align: right;">0.975</th>
<th style="text-align: right;">0.99</th>
<th style="text-align: right;">0.995</th>
<th style="text-align: right;">0.999</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">1.3764</td>
<td style="text-align: right;">3.0777</td>
<td style="text-align: right;">6.3138</td>
<td style="text-align: right;">12.7062</td>
<td style="text-align: right;">31.8205</td>
<td style="text-align: right;">63.6567</td>
<td style="text-align: right;">318.3088</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.8165</td>
<td style="text-align: right;">1.0607</td>
<td style="text-align: right;">1.8856</td>
<td style="text-align: right;">2.9200</td>
<td style="text-align: right;">4.3027</td>
<td style="text-align: right;">6.9646</td>
<td style="text-align: right;">9.9248</td>
<td style="text-align: right;">22.3271</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.7649</td>
<td style="text-align: right;">0.9785</td>
<td style="text-align: right;">1.6377</td>
<td style="text-align: right;">2.3534</td>
<td style="text-align: right;">3.1824</td>
<td style="text-align: right;">4.5407</td>
<td style="text-align: right;">5.8409</td>
<td style="text-align: right;">10.2145</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.7407</td>
<td style="text-align: right;">0.9410</td>
<td style="text-align: right;">1.5332</td>
<td style="text-align: right;">2.1318</td>
<td style="text-align: right;">2.7764</td>
<td style="text-align: right;">3.7469</td>
<td style="text-align: right;">4.6041</td>
<td style="text-align: right;">7.1732</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.7267</td>
<td style="text-align: right;">0.9195</td>
<td style="text-align: right;">1.4759</td>
<td style="text-align: right;">2.0150</td>
<td style="text-align: right;">2.5706</td>
<td style="text-align: right;">3.3649</td>
<td style="text-align: right;">4.0321</td>
<td style="text-align: right;">5.8934</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.7176</td>
<td style="text-align: right;">0.9057</td>
<td style="text-align: right;">1.4398</td>
<td style="text-align: right;">1.9432</td>
<td style="text-align: right;">2.4469</td>
<td style="text-align: right;">3.1427</td>
<td style="text-align: right;">3.7074</td>
<td style="text-align: right;">5.2076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.7111</td>
<td style="text-align: right;">0.8960</td>
<td style="text-align: right;">1.4149</td>
<td style="text-align: right;">1.8946</td>
<td style="text-align: right;">2.3646</td>
<td style="text-align: right;">2.9980</td>
<td style="text-align: right;">3.4995</td>
<td style="text-align: right;">4.7853</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">0.7064</td>
<td style="text-align: right;">0.8889</td>
<td style="text-align: right;">1.3968</td>
<td style="text-align: right;">1.8595</td>
<td style="text-align: right;">2.3060</td>
<td style="text-align: right;">2.8965</td>
<td style="text-align: right;">3.3554</td>
<td style="text-align: right;">4.5008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">0.7027</td>
<td style="text-align: right;">0.8834</td>
<td style="text-align: right;">1.3830</td>
<td style="text-align: right;">1.8331</td>
<td style="text-align: right;">2.2622</td>
<td style="text-align: right;">2.8214</td>
<td style="text-align: right;">3.2498</td>
<td style="text-align: right;">4.2968</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">0.6998</td>
<td style="text-align: right;">0.8791</td>
<td style="text-align: right;">1.3722</td>
<td style="text-align: right;">1.8125</td>
<td style="text-align: right;">2.2281</td>
<td style="text-align: right;">2.7638</td>
<td style="text-align: right;">3.1693</td>
<td style="text-align: right;">4.1437</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section></section><section id="正态总体方差检验" class="level3" data-number="19.1.2"><h3 data-number="19.1.2" class="anchored" data-anchor-id="正态总体方差检验">
<span class="header-section-number">19.1.2</span> 正态总体方差检验</h3>
<p>卡方检验 <span class="math inline">\(\chi^2\)</span> 检验统计量服从卡方分布。</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{I}   \quad H_0: \sigma^2 - \sigma^2_0 \leq 0 \quad vs. \quad H_1: \sigma^2 - \sigma^2_0 &gt; 0 \\
\mathrm{II}  \quad H_0: \sigma^2 - \sigma^2_0 \geq 0 \quad vs. \quad H_1: \sigma^2 - \sigma^2_0 &lt; 0 \\
\mathrm{III} \quad H_0: \sigma^2 - \sigma^2_0 = 0 \quad vs. \quad H_1: \sigma^2 - \sigma^2_0 \neq 0
\end{aligned}
\]</span></p>
<p>一般假定均值 <span class="math inline">\(\mu\)</span> 是未知的。检验统计量服从卡方分布 <span class="math inline">\(\chi^2(n-1)\)</span></p>
<p><span class="math display">\[
\chi^2 = \frac{(n-1)s^2}{\sigma^2_0}
\]</span></p>
<p>设 <span class="math inline">\(\sigma^2_0 = 1.5^2\)</span> ，考虑检验问题 I</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># 检验统计量</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>chi <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fl">1.5</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># 临界值</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="fu">qchisq</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">df =</span> n <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 30.14353</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># P 值</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(<span class="at">q =</span> chi, <span class="at">df =</span> n <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.002183653</code></pre>
</div>
</div>
<p>R 软件提供很多统计分布的计算，因此，不再需要查分位数表，现算即可。计算自由度为 <span class="math inline">\(n\)</span> 概率为 <span class="math inline">\(p\)</span> 的 <span class="math inline">\(\chi^2\)</span> 分布的分位数 <span class="math inline">\(\chi^2_p(n)\)</span> ，即</p>
<p><span class="math display">\[
P(\chi^2(n) \leq \chi^2_p(n)) = p
\]</span></p>
<p>若已知自由度为 1 ，概率为 0.05，则可借助分位数函数 <code><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq()</a></code> 计算对应的（下）分位点。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">qchisq</span>(<span class="at">p =</span> <span class="fl">0.05</span>, <span class="at">df =</span> <span class="dv">1</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.00393214</code></pre>
</div>
</div>
<p>同理，也可以获得 <span class="math inline">\(\chi^2\)</span> 分布的分位数 <a href="#tbl-chisq-quantile" class="quarto-xref">表格&nbsp;<span>19.2</span></a> ，计算出来的分位数保留 4 位小数。</p>
<div class="cell">
<div id="tbl-chisq-quantile" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-chisq-quantile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表格&nbsp;19.2: <span class="math inline">\(\chi^2\)</span> 分布的分位数表
</figcaption><div aria-describedby="tbl-chisq-quantile-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0.005</th>
<th style="text-align: right;">0.01</th>
<th style="text-align: right;">0.025</th>
<th style="text-align: right;">0.05</th>
<th style="text-align: right;">0.1</th>
<th style="text-align: right;">0.9</th>
<th style="text-align: right;">0.95</th>
<th style="text-align: right;">0.975</th>
<th style="text-align: right;">0.99</th>
<th style="text-align: right;">0.995</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0002</td>
<td style="text-align: right;">0.0010</td>
<td style="text-align: right;">0.0039</td>
<td style="text-align: right;">0.0158</td>
<td style="text-align: right;">2.7055</td>
<td style="text-align: right;">3.8415</td>
<td style="text-align: right;">5.0239</td>
<td style="text-align: right;">6.6349</td>
<td style="text-align: right;">7.8794</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.0100</td>
<td style="text-align: right;">0.0201</td>
<td style="text-align: right;">0.0506</td>
<td style="text-align: right;">0.1026</td>
<td style="text-align: right;">0.2107</td>
<td style="text-align: right;">4.6052</td>
<td style="text-align: right;">5.9915</td>
<td style="text-align: right;">7.3778</td>
<td style="text-align: right;">9.2103</td>
<td style="text-align: right;">10.5966</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.0717</td>
<td style="text-align: right;">0.1148</td>
<td style="text-align: right;">0.2158</td>
<td style="text-align: right;">0.3518</td>
<td style="text-align: right;">0.5844</td>
<td style="text-align: right;">6.2514</td>
<td style="text-align: right;">7.8147</td>
<td style="text-align: right;">9.3484</td>
<td style="text-align: right;">11.3449</td>
<td style="text-align: right;">12.8382</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.2070</td>
<td style="text-align: right;">0.2971</td>
<td style="text-align: right;">0.4844</td>
<td style="text-align: right;">0.7107</td>
<td style="text-align: right;">1.0636</td>
<td style="text-align: right;">7.7794</td>
<td style="text-align: right;">9.4877</td>
<td style="text-align: right;">11.1433</td>
<td style="text-align: right;">13.2767</td>
<td style="text-align: right;">14.8603</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.4117</td>
<td style="text-align: right;">0.5543</td>
<td style="text-align: right;">0.8312</td>
<td style="text-align: right;">1.1455</td>
<td style="text-align: right;">1.6103</td>
<td style="text-align: right;">9.2364</td>
<td style="text-align: right;">11.0705</td>
<td style="text-align: right;">12.8325</td>
<td style="text-align: right;">15.0863</td>
<td style="text-align: right;">16.7496</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">0.6757</td>
<td style="text-align: right;">0.8721</td>
<td style="text-align: right;">1.2373</td>
<td style="text-align: right;">1.6354</td>
<td style="text-align: right;">2.2041</td>
<td style="text-align: right;">10.6446</td>
<td style="text-align: right;">12.5916</td>
<td style="text-align: right;">14.4494</td>
<td style="text-align: right;">16.8119</td>
<td style="text-align: right;">18.5476</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.9893</td>
<td style="text-align: right;">1.2390</td>
<td style="text-align: right;">1.6899</td>
<td style="text-align: right;">2.1673</td>
<td style="text-align: right;">2.8331</td>
<td style="text-align: right;">12.0170</td>
<td style="text-align: right;">14.0671</td>
<td style="text-align: right;">16.0128</td>
<td style="text-align: right;">18.4753</td>
<td style="text-align: right;">20.2777</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">1.3444</td>
<td style="text-align: right;">1.6465</td>
<td style="text-align: right;">2.1797</td>
<td style="text-align: right;">2.7326</td>
<td style="text-align: right;">3.4895</td>
<td style="text-align: right;">13.3616</td>
<td style="text-align: right;">15.5073</td>
<td style="text-align: right;">17.5345</td>
<td style="text-align: right;">20.0902</td>
<td style="text-align: right;">21.9550</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">1.7349</td>
<td style="text-align: right;">2.0879</td>
<td style="text-align: right;">2.7004</td>
<td style="text-align: right;">3.3251</td>
<td style="text-align: right;">4.1682</td>
<td style="text-align: right;">14.6837</td>
<td style="text-align: right;">16.9190</td>
<td style="text-align: right;">19.0228</td>
<td style="text-align: right;">21.6660</td>
<td style="text-align: right;">23.5894</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">2.1559</td>
<td style="text-align: right;">2.5582</td>
<td style="text-align: right;">3.2470</td>
<td style="text-align: right;">3.9403</td>
<td style="text-align: right;">4.8652</td>
<td style="text-align: right;">15.9872</td>
<td style="text-align: right;">18.3070</td>
<td style="text-align: right;">20.4832</td>
<td style="text-align: right;">23.2093</td>
<td style="text-align: right;">25.1882</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="总体未知均值检验" class="level3" data-number="19.1.3"><h3 data-number="19.1.3" class="anchored" data-anchor-id="总体未知均值检验">
<span class="header-section-number">19.1.3</span> 总体未知均值检验</h3>
<p>有了均值和方差，为什么还要位置参数和尺度参数？为了更一般地描述问题，扩展范围。特别是在总体分布未知或知之甚少的情况下做检验，不再仅限于均值和方差这样的特征量。</p>
<p>考虑前面正态总体均值检验中的假设 I 的形式，若总体的分布形式未知，则需要 Wilcoxon （威尔科克森）秩和检验 <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> 来做均值的比较。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">wilcox.test</span>(<span class="at">x =</span> x, <span class="at">mu =</span> <span class="dv">1</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Wilcoxon signed rank exact test
#&gt; 
#&gt; data:  x
#&gt; V = 163, p-value = 0.01479
#&gt; alternative hypothesis: true location is greater than 1</code></pre>
</div>
</div>
<p>相比于 t 检验，P 值更小。</p>
</section><section id="总体未知方差检验" class="level3" data-number="19.1.4"><h3 data-number="19.1.4" class="anchored" data-anchor-id="总体未知方差检验">
<span class="header-section-number">19.1.4</span> 总体未知方差检验</h3>
</section></section><section id="sec-two-samples" class="level2" data-number="19.2"><h2 data-number="19.2" class="anchored" data-anchor-id="sec-two-samples">
<span class="header-section-number">19.2</span> 两样本检验</h2>
<div class="cell" data-fig-width="6.5" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-two-samples" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-two-samples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-two-samples">flowchart LR
  A(两样本) --&gt; B1(正态总体)
  A  --&gt; B2(总体未知)
  B1 --&gt; C1(均值检验)
  C1 --&gt; D1(方差已知) --&gt; E1(Z 检验)
  C1 --&gt; D2(方差未知但相等) --&gt; E2(t 检验)
  C1 --&gt; D3(方差未知且不等) --&gt; E3(Welch t 检验)
  B1 --&gt; C2(方差检验) --&gt; E4(F 检验)
  C2 --&gt; E7(Bartlett 检验)
  B2 --&gt; C3(均值检验) --&gt; E5(Wilcoxon 符号秩检验\nKruskal-Wallis 秩和检验)
  B2 --&gt; C4(方差检验) --&gt; E8(Ansari-Bradley 检验\nMood 检验\nFligner-Killeen 检验)
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-two-samples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.2: 两样本检验
</figcaption></figure>
</div>
</div>
</div>
<p>设 <span class="math inline">\(x_1,\cdots,x_{n_1}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_1,\sigma_1^2)\)</span> 的样本，设 <span class="math inline">\(y_1,\cdots,y_{n_2}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_2,\sigma_2^2)\)</span> 的样本。</p>
<section id="正态总体均值检验-1" class="level3" data-number="19.2.1"><h3 data-number="19.2.1" class="anchored" data-anchor-id="正态总体均值检验-1">
<span class="header-section-number">19.2.1</span> 正态总体均值检验</h3>
<p>两样本均值之差的检验</p>
<div class="cell">
<details class="code-fold"><summary>代码</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># 绘制虚线所需的数据</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>const <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb20-4"><a href="#cb20-4"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="at">y =</span> <span class="fu">c</span>(const, <span class="dv">0</span>, const <span class="sc">/</span> <span class="fl">1.5</span>, <span class="dv">0</span>),</span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="st">"dnorm1"</span>, <span class="st">"dnorm1"</span>, <span class="st">"dnorm2"</span>, <span class="st">"dnorm2"</span>),</span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="at">upper =</span> <span class="fu">c</span>(const, <span class="dv">0</span>, const <span class="sc">/</span> <span class="fl">1.5</span>, <span class="dv">0</span>),</span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="at">lower =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb20-10"><a href="#cb20-10"></a>)</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb20-13"><a href="#cb20-13"></a>    <span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb20-14"><a href="#cb20-14"></a>    <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">"dnorm1"</span>), <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb20-15"><a href="#cb20-15"></a>  ) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb20-17"><a href="#cb20-17"></a>    <span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="fl">1.5</span>),</span>
<span id="cb20-18"><a href="#cb20-18"></a>    <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">"dnorm2"</span>), <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb20-19"><a href="#cb20-19"></a>  ) <span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb20-21"><a href="#cb20-21"></a>    <span class="at">dnorm1 =</span> <span class="st">"$</span><span class="sc">\\</span><span class="st">mathcal{N}(</span><span class="sc">\\</span><span class="st">mu_1, </span><span class="sc">\\</span><span class="st">sigma_1^2)$"</span>,</span>
<span id="cb20-22"><a href="#cb20-22"></a>    <span class="at">dnorm2 =</span> <span class="st">"$</span><span class="sc">\\</span><span class="st">mathcal{N}(</span><span class="sc">\\</span><span class="st">mu_2, </span><span class="sc">\\</span><span class="st">sigma_2^2)$"</span></span>
<span id="cb20-23"><a href="#cb20-23"></a>  )) <span class="sc">+</span></span>
<span id="cb20-24"><a href="#cb20-24"></a>  <span class="fu">geom_linerange</span>(</span>
<span id="cb20-25"><a href="#cb20-25"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, <span class="at">colour =</span> group),</span>
<span id="cb20-26"><a href="#cb20-26"></a>    <span class="at">linewidth =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">data =</span> dat</span>
<span id="cb20-27"><a href="#cb20-27"></a>  ) <span class="sc">+</span></span>
<span id="cb20-28"><a href="#cb20-28"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"$</span><span class="sc">\\</span><span class="st">mu_1$"</span>, <span class="at">vjust =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb20-29"><a href="#cb20-29"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">label =</span> <span class="st">"$</span><span class="sc">\\</span><span class="st">mu_2$"</span>, <span class="at">vjust =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb20-31"><a href="#cb20-31"></a>  <span class="fu">theme</span>(<span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb20-32"><a href="#cb20-32"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"$x$"</span>, <span class="at">y =</span> <span class="st">"$f(x)$"</span>, <span class="at">color =</span> <span class="st">"正态分布"</span>) <span class="sc">+</span></span>
<span id="cb20-33"><a href="#cb20-33"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-two-samples-means" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-two-samples-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-two-samples-means-1.png" class="img-fluid figure-img" width="528">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-two-samples-means-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.3: 两样本均值之差的检验
</figcaption></figure>
</div>
</div>
</div>
<p>常见检验问题</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{I}   \quad H_0: \mu_1 - \mu_2 \leq 0 \quad vs. \quad H_1: \mu_1 - \mu_2 &gt; 0 \\
\mathrm{II}  \quad H_0: \mu_1 - \mu_2 \geq 0 \quad vs. \quad H_1: \mu_1 - \mu_2 &lt; 0 \\
\mathrm{III} \quad H_0: \mu_1 - \mu_2 = 0 \quad vs. \quad H_1: \mu_1 - \mu_2 \neq 0
\end{aligned}
\]</span></p>
<section id="方差已知-1" class="level4" data-number="19.2.1.1"><h4 data-number="19.2.1.1" class="anchored" data-anchor-id="方差已知-1">
<span class="header-section-number">19.2.1.1</span> 方差已知</h4>
<p><span class="math display">\[
u = \frac{(\bar{x} - \bar{y}) - (\mu_1 - \mu_2)}{\sqrt{\frac{\sigma^2_1}{n_1} + \frac{\sigma^2_2}{n_2}} }
\]</span></p>
<p>检验统计量服从标准正态分布 <span class="math inline">\(u \sim \mathcal{N}(0,1)\)</span>，检验统计量 <span class="math inline">\(u\)</span> 对应的样本值 <span class="math inline">\(u_0\)</span>，检验的拒绝域和 <span class="math inline">\(P\)</span> 值如下</p>
<p><span class="math display">\[
W_1 = \{u \geq u_{1 - \alpha} \}, \quad p_1 = 1 - \varPhi(u_0)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>n_1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>n_2 <span class="ot">&lt;-</span> <span class="dv">80</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>mu_1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>sigma_1 <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>mu_2 <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>sigma_2 <span class="ot">&lt;-</span> <span class="fl">4.5</span></span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="fu">set.seed</span>(<span class="dv">20232023</span>)</span>
<span id="cb21-9"><a href="#cb21-9"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_1, <span class="at">mean =</span> mu_1, <span class="at">sd =</span> sigma_1)</span>
<span id="cb21-10"><a href="#cb21-10"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n_2, <span class="at">mean =</span> mu_2, <span class="at">sd =</span> sigma_2)</span>
<span id="cb21-11"><a href="#cb21-11"></a>u0 <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x1) <span class="sc">-</span> <span class="fu">mean</span>(y1)) <span class="sc">/</span> <span class="fu">sqrt</span>(sigma_1<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> n_1 <span class="sc">+</span> sigma_2<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> n_2)</span>
<span id="cb21-12"><a href="#cb21-12"></a>u0</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 6.779039</code></pre>
</div>
</div>
<p>对检验问题 I，给定显著性水平 <span class="math inline">\(\alpha = 0.05\)</span>，得出拒绝域 <span class="math inline">\(\{ u \geq 1.645\}\)</span>，计算样本观察值得到的检验统计量的值 <span class="math inline">\(u_0 = 6.779\)</span>，而该值落在拒绝域，所以拒绝原假设，即拒绝 <span class="math inline">\(\mu_1 - \mu_2 \leq 0\)</span>，则接受 <span class="math inline">\(\mu_1 - \mu_2 &gt; 0\)</span>。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># 计算拒绝域</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.644854</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># 计算 P 值</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(u0)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 6.048939e-12</code></pre>
</div>
</div>
</section><section id="方差未知但相等" class="level4" data-number="19.2.1.2"><h4 data-number="19.2.1.2" class="anchored" data-anchor-id="方差未知但相等">
<span class="header-section-number">19.2.1.2</span> 方差未知但相等</h4>
<p>设 <span class="math inline">\(x_1,\cdots,x_{n_1}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_1,\sigma^2)\)</span> 的样本，设 <span class="math inline">\(y_1,\cdots,y_{n_2}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_2,\sigma^2)\)</span> 的样本。</p>
<p>t 检验，检验统计量服从自由度为 <span class="math inline">\(n_1 + n_2 - 2\)</span> 的 t 分布</p>
<p><span class="math display">\[
t = \frac{(\bar{x} -\bar{y})-(\mu_1 - \mu_2)}{s_0\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}
\]</span></p>
<p>其中，</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \bar{x} = \sum_{i=1}^{n_1}x_i \quad \bar{y} = \sum_{i=1}^{n_2}y_i \\
&amp; s_0^2 = \frac{1}{n_1 + n_2 - 2}\big(\sum_{i=1}^{n_1}(x_i - \bar{x})^2 + \sum_{i=1}^{n_2}(y_i - \bar{y})^2\big)
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>s_w <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">/</span> (n_1 <span class="sc">+</span> n_2 <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> ((n_1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(x1) <span class="sc">+</span> (n_2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(y1)))</span>
<span id="cb27-2"><a href="#cb27-2"></a>t0 <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x1) <span class="sc">-</span> <span class="fu">mean</span>(y1)) <span class="sc">/</span> (s_w <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">/</span> n_1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n_2))</span>
<span id="cb27-3"><a href="#cb27-3"></a>t0</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 8.155781</code></pre>
</div>
</div>
<p>样本观察值 <span class="math inline">\(t_0 = 8.155 &gt; t_{0.95}(n_1 + n_2 -2) = 1.653\)</span> 落在拒绝域内，对于检验问题 I 我们要拒绝原假设</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># 临界值：0.95 分位点对应的分位数</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">df =</span> n_1 <span class="sc">+</span> n_2 <span class="sc">-</span> <span class="dv">2</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.653459</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># p 值</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(t0, <span class="at">df =</span> n_1 <span class="sc">+</span> n_2 <span class="sc">-</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 3.019807e-14</code></pre>
</div>
</div>
<p>利用 R 内置的 <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 函数计算</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y1, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Two Sample t-test
#&gt; 
#&gt; data:  x1 and y1
#&gt; t = 8.1558, df = 178, p-value = 3.016e-14
#&gt; alternative hypothesis: true difference in means is greater than 0
#&gt; 95 percent confidence interval:
#&gt;  3.036384      Inf
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt; 10.338905  6.530406</code></pre>
</div>
</div>
<p>检验统计量的值及对应的 P 值都是一样的。睡眠数据 sleep 记录了两种药物对病人睡眠时间的影响，此数据集由 “Student”（哥塞特的笔名） 收集。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># 方差未知但相等</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">t.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Two Sample t-test
#&gt; 
#&gt; data:  extra by group
#&gt; t = -1.8608, df = 18, p-value = 0.07919
#&gt; alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -3.363874  0.203874
#&gt; sample estimates:
#&gt; mean in group 1 mean in group 2 
#&gt;            0.75            2.33</code></pre>
</div>
</div>
</section><section id="方差未知且不等" class="level4" data-number="19.2.1.3"><h4 data-number="19.2.1.3" class="anchored" data-anchor-id="方差未知且不等">
<span class="header-section-number">19.2.1.3</span> 方差未知且不等</h4>
<p>两个样本的样本量不是很大，总体方差也未知，两样本均值之差的显著性检验，即著名的 Behrens-Fisher 问题，Welch 在 1938 年提出近似服从自由度为 <span class="math inline">\(l\)</span> 的 t 分布。</p>
<p>两样本的样本量很大，尽管总体方差未知，两样本均值之差的显著性检验，极限分布是正态分布，可以用 Z 检验。在样本量很大的情况下，Welch t 检验也可以用。</p>
<p>设 <span class="math inline">\(x_1,\cdots,x_{n_1}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_1,\sigma_1^2)\)</span> 的 IID 样本，设 <span class="math inline">\(y_1,\cdots,y_{n_2}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_2,\sigma_2^2)\)</span> 的 IID 样本。</p>
<p>Welch（韦尔奇） t 检验</p>
<p><span class="math display">\[
T = \frac{(\bar{x} - \bar{y}) - (\mu_1 - \mu_2)}{\sqrt{\frac{s_x^2}{n_1} + \frac{s_y^2}{n_2}} }
\]</span></p>
<p>其中，<span class="math inline">\(s_x^2\)</span> 表示样本 x 的方差 <span class="math inline">\(s_x^2 = \frac{1}{n_1-1}\sum_{i=1}^{n_1}(x_i -\bar{x})^2\)</span> ，<span class="math inline">\(s_y^2\)</span> 表示样本 y 的方差 <span class="math inline">\(s_y^2 = \frac{1}{n_2-1}\sum_{i=1}^{n_2}(y_i -\bar{y})^2\)</span> 。检验统计量 <span class="math inline">\(T\)</span> 服从自由度为 <span class="math inline">\(l\)</span> 的 t 分布。</p>
<p><span class="math display">\[
l = \frac{s_0^4}{ \frac{s_x^4}{n_1^2(n_1 - 1)} + \frac{s_y^4}{n_2^2(n_2-1)} }
\]</span></p>
<p>其中， <span class="math inline">\(s_0^2 = s_x^2 / n_1 + s_y^2/n_2\)</span>，<span class="math inline">\(l\)</span> 通常不是整数，实际使用时，<span class="math inline">\(l\)</span> 可取最近的整数。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>s0 <span class="ot">&lt;-</span> <span class="fu">var</span>(x1) <span class="sc">/</span> n_1 <span class="sc">+</span> <span class="fu">var</span>(y1) <span class="sc">/</span> n_2</span>
<span id="cb37-2"><a href="#cb37-2"></a>l <span class="ot">&lt;-</span> s0<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="fu">var</span>(x1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n_1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (n_1 <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">var</span>(y1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n_2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (n_2 <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb37-3"><a href="#cb37-3"></a>l</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 126.7708</code></pre>
</div>
</div>
<p>所以， <span class="math inline">\(l\)</span> 可取 127。检验统计量的值如下</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>t0 <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x1) <span class="sc">-</span> <span class="fu">mean</span>(y1)) <span class="sc">/</span> <span class="fu">sqrt</span>(s0)</span>
<span id="cb39-2"><a href="#cb39-2"></a>t0</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 7.77002</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># 临界值：0.95 分位点对应的分位数</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">df =</span> <span class="dv">127</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.65694</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># p 值</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(t0, <span class="at">df =</span> <span class="fl">126.7708</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>) </span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.162404e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># 就近取整</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(t0, <span class="at">df =</span> <span class="dv">127</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.153078e-12</code></pre>
</div>
</div>
<p>与函数 <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 比较，值得注意，t 分布的自由度可以为非整数。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> x1, <span class="at">y =</span> y1, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  x1 and y1
#&gt; t = 7.77, df = 126.77, p-value = 1.162e-12
#&gt; alternative hypothesis: true difference in means is greater than 0
#&gt; 95 percent confidence interval:
#&gt;  2.996334      Inf
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt; 10.338905  6.530406</code></pre>
</div>
</div>
<p>举例：sleep 数据集</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sleep" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-sleep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-sleep-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sleep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.4: 学生睡眠数据的分布
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># 方差未知且不等</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="fu">t.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  extra by group
#&gt; t = -1.8608, df = 17.776, p-value = 0.07939
#&gt; alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -3.3654832  0.2054832
#&gt; sample estimates:
#&gt; mean in group 1 mean in group 2 
#&gt;            0.75            2.33</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注释
</div>
</div>
<div class="callout-body-container callout-body">
<p>Egon Pearson 接过他父亲 Karl Pearson 的职位，担任伦敦大学学院的高尔顿统计教授。许宝騄（Pao-Lu Hsu）在 Jerzy Neyman 和 Egon Pearson 主编的杂志《Statistical Research Memoirs》发表第一篇关于 Behrens-Fisher 问题的论文 <span class="citation" data-cites="Hsu1938">(<a href="references.html#ref-Hsu1938" role="doc-biblioref">HSU 1938</a>)</span>，1998 年关于 Behrens-Fisher 问题的综述 <span class="citation" data-cites="Kim1998">(<a href="references.html#ref-Kim1998" role="doc-biblioref">Kim 和 Cohen 1998</a>)</span>。陈家鼎和郑忠国一起整理了许宝騄的生平事迹和学术成就，见<a href="https://www.math.pku.edu.cn/misc/probstat/doc.pdf">《许宝騄先生的生平和学术成就》</a>。钟开涞（Kai-Lai Chung）将许宝騄的论文集整理出版 <span class="citation" data-cites="HSU1983">(<a href="references.html#ref-HSU1983" role="doc-biblioref">HSU 1983</a>)</span>。</p>
</div>
</div>
<p>t 检验的影响是如此巨大，以至于广泛存在于具有统计功能的软件中，比如办公软件里的 t 检验。以 MacOS 上的 Numbers 表格软件为例，如 <a href="#fig-numbers-ttest" class="quarto-xref">图&nbsp;<span>19.5</span></a> 所示，首先打开 Numbers 软件，新建工作表，输入两组数值，然后点击空白处，再从顶部导航栏找到「插入」菜单，「公式」选项，点击扩展选项「新建公式」，在弹出的会话条里输入 TTEST，依次选择第一组，第二组值，检验类型和样本类型，最后点击确认，即可得到两样本 t 检验的 P 值结果。</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-numbers-ttest" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-numbers-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="screenshots/number-ttest.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-numbers-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.5: 办公软件 Numbers 的两样本 t 检验
</figcaption></figure>
</div>
</div>
</div>
<p>微软 Excel 办公软件也提供 t 检验计算器，和 MacOS 系统上的 Numbers 办公软件类似，它提供 <code>T.TEST</code> 函数，计算结果也一样，此处从略。R 软件自带 <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 函数，也是用于做 t 检验，如下：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">19</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">14</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">17</span>, <span class="dv">1</span>))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  c(3, 4, 5, 8, 9, 1, 2, 4, 5) and c(6, 19, 3, 2, 14, 4, 5, 17, 1)
#&gt; t = -1.3622, df = 10.255, p-value = 0.2023
#&gt; alternative hypothesis: true difference in means is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -8.767183  2.100516
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt;  4.555556  7.888889</code></pre>
</div>
</div>
</section></section><section id="正态总体方差检验-1" class="level3" data-number="19.2.2"><h3 data-number="19.2.2" class="anchored" data-anchor-id="正态总体方差检验-1">
<span class="header-section-number">19.2.2</span> 正态总体方差检验</h3>
<p>比较两个正态总体的方差是否相等，F 检验。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># 两样本</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="fu">var.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  F test to compare two variances
#&gt; 
#&gt; data:  extra by group
#&gt; F = 0.79834, num df = 9, denom df = 9, p-value = 0.7427
#&gt; alternative hypothesis: true ratio of variances is not equal to 1
#&gt; 95 percent confidence interval:
#&gt;  0.198297 3.214123
#&gt; sample estimates:
#&gt; ratio of variances 
#&gt;          0.7983426</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># 或者</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="fu">bartlett.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Bartlett test of homogeneity of variances
#&gt; 
#&gt; data:  extra by group
#&gt; Bartlett's K-squared = 0.10789, df = 1, p-value = 0.7426</code></pre>
</div>
</div>
<p>注意：函数 <code><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test()</a></code> 支持多样本情况。</p>
</section><section id="总体未知均值检验-1" class="level3" data-number="19.2.3"><h3 data-number="19.2.3" class="anchored" data-anchor-id="总体未知均值检验-1">
<span class="header-section-number">19.2.3</span> 总体未知均值检验</h3>
<p>在总体分布未知的情况下，比较均值是否相等的检验。</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> 适用于单样本和两样本的均值检验，单样本 Wilcoxon 秩和检验，两样本 Wilcoxon 符号秩和检验，后者也叫 Mann-Whitney 检验。</li>
<li>
<code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code> 适用于两样本和多样本，比较多个均值是否相等的检验，Kruskal-Wallis 秩和检验。</li>
</ul>
<p>单样本和两样本 <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code>。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">wilcox.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
#&gt; compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Wilcoxon rank sum test with continuity correction
#&gt; 
#&gt; data:  extra by group
#&gt; W = 25.5, p-value = 0.06933
#&gt; alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p><strong>coin</strong> 包提供渐进 Wilcoxon-Mann-Whitney 检验</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Asymptotic Wilcoxon-Mann-Whitney Test</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">wilcox_test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Asymptotic Wilcoxon-Mann-Whitney Test
#&gt; 
#&gt; data:  extra by group (1, 2)
#&gt; Z = -1.8541, p-value = 0.06372
#&gt; alternative hypothesis: true mu is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -3.500000e+00  1.270214e-10
#&gt; sample estimates:
#&gt; difference in location 
#&gt;              -1.347344</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Exact Wilcoxon-Mann-Whitney Test</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="fu">wilcox_test</span>(</span>
<span id="cb62-3"><a href="#cb62-3"></a>  extra <span class="sc">~</span> group, <span class="at">data =</span> sleep,</span>
<span id="cb62-4"><a href="#cb62-4"></a>  <span class="at">distribution =</span> <span class="st">"exact"</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Exact Wilcoxon-Mann-Whitney Test
#&gt; 
#&gt; data:  extra by group (1, 2)
#&gt; Z = -1.8541, p-value = 0.06582
#&gt; alternative hypothesis: true mu is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -3.5  0.0
#&gt; sample estimates:
#&gt; difference in location 
#&gt;                  -1.35</code></pre>
</div>
</div>
<p>两样本和多样本 <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code> 。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">kruskal.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Kruskal-Wallis rank sum test
#&gt; 
#&gt; data:  extra by group
#&gt; Kruskal-Wallis chi-squared = 3.4378, df = 1, p-value = 0.06372</code></pre>
</div>
</div>
<p>能用参数检验的一定也可以用非参数检验，一般来说，非参数检验的功效不小于参数检验，非参数检验不要求分布是正态，比如此时 P 值从 0.07939 降至 0.06372。</p>
</section><section id="总体未知方差检验-1" class="level3" data-number="19.2.4"><h3 data-number="19.2.4" class="anchored" data-anchor-id="总体未知方差检验-1">
<span class="header-section-number">19.2.4</span> 总体未知方差检验</h3>
<p>对总体没有分布要求的方差齐性检验方法有三个，按适用范围分类，见下 <a href="#tbl-fligner-test" class="quarto-xref">表格&nbsp;<span>19.3</span></a> 。</p>
<div id="tbl-fligner-test" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fligner-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表格&nbsp;19.3: 检验方法分类
</figcaption><div aria-describedby="tbl-fligner-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 48%">
<col style="width: 51%">
</colgroup>
<thead><tr class="header">
<th>两个样本</th>
<th>多个样本</th>
</tr></thead>
<tbody><tr class="odd">
<td><ul>
<li>Ansari-Bradley 检验 <code><a href="https://rdrr.io/r/stats/ansari.test.html">ansari.test()</a></code>
</li>
<li>Mood 检验 <code><a href="https://rdrr.io/r/stats/mood.test.html">mood.test()</a></code>
</li>
</ul></td>
<td><ul>
<li>Fligner-Killeen 检验 <code><a href="https://rdrr.io/r/stats/fligner.test.html">fligner.test()</a></code>
</li>
</ul></td>
</tr></tbody>
</table>
</div>
</figure>
</div>
<p>以 A. R. Ansari 和 R. A. Bradley 命名的 Ansari-Bradley 检验 <span class="citation" data-cites="ansari1960">(<a href="references.html#ref-ansari1960" role="doc-biblioref">Ansari 和 Bradley 1960</a>)</span>，对应的 R 函数是 <code><a href="https://rdrr.io/r/stats/ansari.test.html">ansari.test()</a></code> ，以 A. M. Mood 命名的 Mood 检验 <span class="citation" data-cites="mood1954">(<a href="references.html#ref-mood1954" role="doc-biblioref">Mood 1954</a>)</span>，对应的 R 函数是 <code><a href="https://rdrr.io/r/stats/mood.test.html">mood.test()</a></code> ，这两者都属于两样本的非参数检验，检验尺度参数是否相同（齐性）。以 M. A. Fligner 和 T. J. Killeen 命名的 Fligner-Killeen 检验 <span class="citation" data-cites="fligner1976">(<a href="references.html#ref-fligner1976" role="doc-biblioref">Fligner 和 Killeen 1976</a>)</span>，对应的 R 函数是 <code><a href="https://rdrr.io/r/stats/fligner.test.html">fligner.test()</a></code> ，也属于非参数检验，适用于两样本和多样本的情况。非参数检验常涉及位置参数和尺度参数这一对概念，就正态分布而言，位置参数可以理解为均值 <span class="math inline">\(\mu\)</span> ，尺度参数可以理解为方差 <span class="math inline">\(\sigma^2\)</span> 。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">ansari.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in ansari.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
#&gt; compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Ansari-Bradley test
#&gt; 
#&gt; data:  extra by group
#&gt; AB = 50.5, p-value = 0.4927
#&gt; alternative hypothesis: true ratio of scales is not equal to 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">mood.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Mood two-sample test of scale
#&gt; 
#&gt; data:  extra by group
#&gt; Z = 0.44761, p-value = 0.6544
#&gt; alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">fligner.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Fligner-Killeen test of homogeneity of variances
#&gt; 
#&gt; data:  extra by group
#&gt; Fligner-Killeen:med chi-squared = 0.21252, df = 1, p-value = 0.6448</code></pre>
</div>
</div>
</section></section><section id="sec-multi-samples" class="level2" data-number="19.3"><h2 data-number="19.3" class="anchored" data-anchor-id="sec-multi-samples">
<span class="header-section-number">19.3</span> 多样本检验</h2>
<div class="cell" data-fig-width="6.5" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-k-samples" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-k-samples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-k-samples">flowchart LR
  A(多样本) --&gt; B1(正态总体)
  A  --&gt; B2(总体未知)
  B1 --&gt; C1(均值检验)
  C1 --&gt; D2(方差相等) --&gt; E2(F 检验)
  C1 --&gt; D3(方差不等) --&gt; E3(F 检验)
  B1 --&gt; C2(方差检验) --&gt; E4(Hartley 检验\n Bartlett 检验\n 修正的 Bartlett 检验\n Levene 检验)
  B2 --&gt; C3(均值检验) --&gt; E5(Kruskal-Wallis 秩和检验\n Friedman 秩和检验\n Quade 检验)
  B2 --&gt; C4(方差检验) --&gt; E7(Fligner-Killeen 检验)
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-k-samples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.6: 多样本检验
</figcaption></figure>
</div>
</div>
</div>
<p>本节考虑 Base R 内置的 PlantGrowth 数据集，它收集自 Annette J. Dobson 所著书籍《An Introduction to Statistical Modelling》<span class="citation" data-cites="Dobson1983">(<a href="references.html#ref-Dobson1983" role="doc-biblioref">Dobson 1983</a>)</span> 第 2 章第 2 节的案例 — 研究植物在两种不同试验条件下的生长情况，植物通过光合作用吸收土壤的养分和空气中的二氧化碳，完成积累，故以植物的干重来刻画植物的生长情况，首先将几乎相同的种子随机地分配到实验组和对照组，基于完全随机实验设计（completely randomized experimental design），经过预定的时间后，将植物收割，干燥并称重。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">str</span>(PlantGrowth)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 'data.frame':    30 obs. of  2 variables:
#&gt;  $ weight: num  4.17 5.58 5.18 6.11 4.5 4.61 5.17 4.53 5.33 5.14 ...
#&gt;  $ group : Factor w/ 3 levels "ctrl","trt1",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
</div>
<p>设立对照组（控制组）ctrl 和实验组 trt1 和 trt2，比较不同的处理方式对植物干重的影响</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">summary</span>(PlantGrowth)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      weight       group   
#&gt;  Min.   :3.590   ctrl:10  
#&gt;  1st Qu.:4.550   trt1:10  
#&gt;  Median :5.155   trt2:10  
#&gt;  Mean   :5.073            
#&gt;  3rd Qu.:5.530            
#&gt;  Max.   :6.310</code></pre>
</div>
</div>
<p>每个组都有 10 颗植物，生长情况如 <a href="#fig-plant-growth" class="quarto-xref">图&nbsp;<span>19.7</span></a> 所示</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="do">## Annette J. Dobson 扩展的 Plant Weight Data 数据，见 59 页</span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="fu">ggplot</span>(<span class="at">data =</span> PlantGrowth, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> weight, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb77-5"><a href="#cb77-5"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plant-growth" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-plant-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-plant-growth-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plant-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.7: 植物干重
</figcaption></figure>
</div>
</div>
</div>
<section id="正态总体均值检验-2" class="level3" data-number="19.3.1"><h3 data-number="19.3.1" class="anchored" data-anchor-id="正态总体均值检验-2">
<span class="header-section-number">19.3.1</span> 正态总体均值检验</h3>
<section id="假定同方差" class="level4" data-number="19.3.1.1"><h4 data-number="19.3.1.1" class="anchored" data-anchor-id="假定同方差">
<span class="header-section-number">19.3.1.1</span> 假定同方差</h4>
<p>讲清楚原假设和备择假设。讲清楚假设检验、方差分析、一般线性模型（包含广义线性模型和线性混合效应模型）的关系。</p>
<p><span class="math inline">\(\sigma_i^2 = \mathsf{Var}\{\epsilon_{ij}\}, i = 1,2,3\)</span> 表示第 <span class="math inline">\(i\)</span> 组的方差，</p>
<p><span class="math display">\[
y_{ij} = \mu + \epsilon_{ij}, i = 1,2,3
\]</span></p>
<p>其中 <span class="math inline">\(\mu\)</span> 是固定的未知参数。单因素方差分析 <code><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test()</a></code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># 假设各组方差相同</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="fu">oneway.test</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  One-way analysis of means
#&gt; 
#&gt; data:  weight and group
#&gt; F = 4.8461, num df = 2, denom df = 27, p-value = 0.01591</code></pre>
</div>
</div>
<p>线性模型也假定各个组的方差是相同的，模型显著性检验的结果和上面是一致的。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>fit_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="fu">anova</span>(fit_lm) <span class="co"># 或者 summary(fit)</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: weight
#&gt;           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
#&gt; group      2  3.7663  1.8832  4.8461 0.01591 *
#&gt; Residuals 27 10.4921  0.3886                  
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>模型输出整理成 <a href="#tbl-lm-plant-growth" class="quarto-xref">表格&nbsp;<span>19.4</span></a></p>
<div class="cell">
<div id="tbl-lm-plant-growth" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lm-plant-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表格&nbsp;19.4: 线性回归的输出
</figcaption><div aria-describedby="tbl-lm-plant-growth-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">估计值</th>
<th style="text-align: right;">标准差</th>
<th style="text-align: right;">t 统计量</th>
<th style="text-align: right;">P 值</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\alpha\)</span></td>
<td style="text-align: right;">5.032</td>
<td style="text-align: right;">0.1971</td>
<td style="text-align: right;">25.5265</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\beta_1\)</span></td>
<td style="text-align: right;">-0.371</td>
<td style="text-align: right;">0.2788</td>
<td style="text-align: right;">-1.3308</td>
<td style="text-align: right;">0.1944</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\beta_2\)</span></td>
<td style="text-align: right;">0.494</td>
<td style="text-align: right;">0.2788</td>
<td style="text-align: right;">1.7720</td>
<td style="text-align: right;">0.0877</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="假定异方差" class="level4" data-number="19.3.1.2"><h4 data-number="19.3.1.2" class="anchored" data-anchor-id="假定异方差">
<span class="header-section-number">19.3.1.2</span> 假定异方差</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co"># 计算各个组的方差</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="fu">aggregate</span>(<span class="at">data =</span> PlantGrowth, weight <span class="sc">~</span> group, <span class="at">FUN =</span> var)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   group    weight
#&gt; 1  ctrl 0.3399956
#&gt; 2  trt1 0.6299211
#&gt; 3  trt2 0.1958711</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co"># 或者</span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="fu">with</span>(PlantGrowth, <span class="fu">tapply</span>(weight, group, var))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      ctrl      trt1      trt2 
#&gt; 0.3399956 0.6299211 0.1958711</code></pre>
</div>
</div>
<p>各个组的方差确实不太相同。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="co"># 假设各组方差不同</span></span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="fu">oneway.test</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  One-way analysis of means (not assuming equal variances)
#&gt; 
#&gt; data:  weight and group
#&gt; F = 5.181, num df = 2.000, denom df = 17.128, p-value = 0.01739</code></pre>
</div>
</div>
<p>线性混合效应模型，假定每一组（层）有不同的方差。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>fit_gls <span class="ot">&lt;-</span> nlme<span class="sc">::</span><span class="fu">gls</span>(weight <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb88-2"><a href="#cb88-2"></a>  <span class="at">data =</span> PlantGrowth, <span class="at">method =</span> <span class="st">"ML"</span>,</span>
<span id="cb88-3"><a href="#cb88-3"></a>  <span class="at">weights =</span> nlme<span class="sc">::</span><span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> group)</span>
<span id="cb88-4"><a href="#cb88-4"></a>)</span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="fu">summary</span>(fit_gls)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Generalized least squares fit by maximum likelihood
#&gt;   Model: weight ~ 1 
#&gt;   Data: PlantGrowth 
#&gt;        AIC      BIC    logLik
#&gt;   67.99884 73.60363 -29.99942
#&gt; 
#&gt; Variance function:
#&gt;  Structure: Different standard deviations per stratum
#&gt;  Formula: ~1 | group 
#&gt;  Parameter estimates:
#&gt;      ctrl      trt1      trt2 
#&gt; 1.0000000 1.6028758 0.9103568 
#&gt; 
#&gt; Coefficients:
#&gt;                Value Std.Error  t-value p-value
#&gt; (Intercept) 5.205999  0.115762 44.97158       0
#&gt; 
#&gt; Standardized residuals:
#&gt;         Min          Q1         Med          Q3         Max 
#&gt; -1.78654574 -0.92900218 -0.08794552  0.61374803  2.09128348 
#&gt; 
#&gt; Residual standard error: 0.5798892 
#&gt; Degrees of freedom: 30 total; 29 residual</code></pre>
</div>
</div>
<p>考虑每个组有不同的方差，放开同方差的假设，发现，从对数似然的角度来看，有一定提升。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="fu">logLik</span>(fit_lm)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 'log Lik.' -26.80952 (df=4)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">logLik</span>(fit_gls)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 'log Lik.' -29.99942 (df=4)</code></pre>
</div>
</div>
</section></section><section id="正态总体方差检验-2" class="level3" data-number="19.3.2"><h3 data-number="19.3.2" class="anchored" data-anchor-id="正态总体方差检验-2">
<span class="header-section-number">19.3.2</span> 正态总体方差检验</h3>
<p>总体服从正态分布，有四种常见的参数检验方法：</p>
<ol type="1">
<li>Hartley 检验：各组样本量必须相等。</li>
<li>Bartlett 检验：各组样本量可以相等或不等，但每个组的样本量必须不低于 5。</li>
<li>修正的 Bartlett 检验：在样本量较大或较小、相等或不等场合都可使用。</li>
<li>Levene 检验：相当于单因素组间方差分析，相比于 Bartlett 检验，Levene 检验更加稳健。</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
提示
</div>
</div>
<div class="callout-body-container callout-body">
<p>在总体分布未知的情况下，检验方差齐性的非参数方法也都可以用在这里。</p>
</div>
</div>
<p>设 <span class="math inline">\(x_1,\cdots,x_{n_1}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_1,\sigma_1^2)\)</span> 的样本，设 <span class="math inline">\(y_1,\cdots,y_{n_2}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_2,\sigma_2^2)\)</span> 的样本，设 <span class="math inline">\(z_1,\cdots,z_{n_3}\)</span> 是来自总体 <span class="math inline">\(\mathcal{N}(\mu_3,\sigma_3^2)\)</span> 的样本。</p>
<p><span class="math display">\[
\sigma_1^2 = \sigma_2^2 = \sigma_3^2 \quad vs. \quad \sigma_1^2,\sigma_2^2,\sigma_3^2 \quad  \text{不全相等}
\]</span></p>
<p>Bartlett （巴特利特）检验 <code><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test()</a></code> 要求总体的分布为正态分布，检验各个组的方差是否有显著性差异，即方差齐性检验，属于参数检验，适用于多个样本的情况。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co"># 三样本</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="fu">bartlett.test</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Bartlett test of homogeneity of variances
#&gt; 
#&gt; data:  weight by group
#&gt; Bartlett's K-squared = 2.8786, df = 2, p-value = 0.2371</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="co"># 或者</span></span>
<span id="cb96-2"><a href="#cb96-2"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Levene's Test for Homogeneity of Variance (center = median)
#&gt;       Df F value Pr(&gt;F)
#&gt; group  2  1.1192 0.3412
#&gt;       27</code></pre>
</div>
</div>
</section><section id="总体未知均值检验-2" class="level3" data-number="19.3.3"><h3 data-number="19.3.3" class="anchored" data-anchor-id="总体未知均值检验-2">
<span class="header-section-number">19.3.3</span> 总体未知均值检验</h3>
<p>Kruskal-Wallis 秩和检验 <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code> 检验均值是否齐性。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="fu">kruskal.test</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Kruskal-Wallis rank sum test
#&gt; 
#&gt; data:  weight by group
#&gt; Kruskal-Wallis chi-squared = 7.9882, df = 2, p-value = 0.01842</code></pre>
</div>
</div>
<p>等价的线性模型表示</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>fit_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(weight) <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="fu">anova</span>(fit_lm) <span class="co"># summary(fit_lm)</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: rank(weight)
#&gt;           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
#&gt; group      2  618.95 309.475  5.1324 0.01291 *
#&gt; Residuals 27 1628.05  60.298                  
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Friedman 秩和检验是非参数检验。适用于单因素重复测量数据的方差分析，检验是否存在一组值显著高于或低于其他组。针对 unreplicated blocked data</p>
<p>典型场景：n 个品酒师对 k 瓶葡萄酒打分，是否存在一组打分显著高于其他组。检验睡眠质量一组人显著好于另一组人。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">friedman.test</span>(extra <span class="sc">~</span> group <span class="sc">|</span> ID, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Friedman rank sum test
#&gt; 
#&gt; data:  extra and group and ID
#&gt; Friedman chi-squared = 9, df = 1, p-value = 0.0027</code></pre>
</div>
</div>
<p><code>formula</code> 参数取值为 <code>a ~ b | c</code> ，<code>a</code> 表示数据值，<code>b</code> 分组变量 groups，<code>c</code> 表示 blocks。</p>
<p>Quade 检验 <code><a href="https://rdrr.io/r/stats/quade.test.html">quade.test()</a></code> 与 Friedman 检验类似，Quade 检验应用于 unreplicated complete block designs。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># 睡眠实验</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="fu">quade.test</span>(extra <span class="sc">~</span> group <span class="sc">|</span> ID, <span class="at">data =</span> sleep)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Quade test
#&gt; 
#&gt; data:  extra and group and ID
#&gt; Quade F = 28.557, num df = 1, denom df = 9, p-value = 0.0004661</code></pre>
</div>
</div>
<p>术语涉及实验设计，比如完全区组设计 complete block designs 。1879 年迈克尔逊光速测量数据记录了五次实验，每次试验测量 20 次光速。数据集 morley 中光速 Speed 已经编码过了，为了展示方便，原始观测速度减去了 299000 (km/sec)。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># 光速实验</span></span>
<span id="cb106-2"><a href="#cb106-2"></a><span class="fu">quade.test</span>(Speed <span class="sc">~</span> Expt <span class="sc">|</span> Run, <span class="at">data =</span> morley)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Quade test
#&gt; 
#&gt; data:  Speed and Expt and Run
#&gt; Quade F = 3.6494, num df = 4, denom df = 76, p-value = 0.008976</code></pre>
</div>
</div>
<!-- 重复测量数据：试验设计的巧妙 -->
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> morley, <span class="fu">aes</span>(<span class="at">x =</span> Expt, <span class="at">y =</span> Speed, <span class="at">group =</span> Expt)) <span class="sc">+</span></span>
<span id="cb108-2"><a href="#cb108-2"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb108-3"><a href="#cb108-3"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb108-4"><a href="#cb108-4"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Expt"</span>, <span class="at">y =</span> <span class="st">"Speed (km/sec)"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-morley" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-morley-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-morley-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-morley-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.8: 1879 年迈克尔逊光速实验数据
</figcaption></figure>
</div>
</div>
</div>
</section><section id="总体未知方差检验-2" class="level3" data-number="19.3.4"><h3 data-number="19.3.4" class="anchored" data-anchor-id="总体未知方差检验-2">
<span class="header-section-number">19.3.4</span> 总体未知方差检验</h3>
<p>三个及以上样本的方差齐性检验。进一步地，我们在线性模型的基础上考虑每个实验组有不同的方差，先做方差齐性检验。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="co"># 非参数检验</span></span>
<span id="cb109-2"><a href="#cb109-2"></a><span class="fu">fligner.test</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Fligner-Killeen test of homogeneity of variances
#&gt; 
#&gt; data:  weight by group
#&gt; Fligner-Killeen:med chi-squared = 2.3499, df = 2, p-value = 0.3088</code></pre>
</div>
</div>
<p>检验的结果显示，可以认为三个组的方差没有显著差异。</p>
</section></section><section id="sec-pairwise-data" class="level2" data-number="19.4"><h2 data-number="19.4" class="anchored" data-anchor-id="sec-pairwise-data">
<span class="header-section-number">19.4</span> 配对样本检验</h2>
<p>配对样本检验算是两样本检验的一种特殊情况。若待检验的样本不止两个，则两两配对检验。</p>
<div id="tbl-paired-test" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-paired-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表格&nbsp;19.5: 配对样本检验
</figcaption><div aria-describedby="tbl-paired-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 72%">
</colgroup>
<thead><tr class="header">
<th>样本</th>
<th>R 函数</th>
</tr></thead>
<tbody><tr class="odd">
<td>两样本</td>
<td><ul>
<li>
<code>t.test(paired = TRUE)</code> 正态总体均值检验</li>
<li>
<code>wilcox.test(paired = TRUE)</code> 总体未知均值检验</li>
</ul></td>
</tr></tbody>
</table>
</div>
</figure>
</div>
<section id="sec-paired-t-test" class="level3" data-number="19.4.1"><h3 data-number="19.4.1" class="anchored" data-anchor-id="sec-paired-t-test">
<span class="header-section-number">19.4.1</span> 配对 t 检验</h3>
<p>做两个组的配对 t 检验，函数 <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> 的参数 <code>paired</code> 设置为 <code>TRUE</code> ，两个组的样本当作配对样本处理。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="fu">t.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Paired t-test
#&gt; 
#&gt; data:  extra by group
#&gt; t = -4.0621, df = 9, p-value = 0.002833
#&gt; alternative hypothesis: true mean difference is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -2.4598858 -0.7001142
#&gt; sample estimates:
#&gt; mean difference 
#&gt;           -1.58</code></pre>
</div>
</div>
<p>做多个组的两两配对 t 检验，函数 <code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test()</a></code> 的参数 <code>paired</code> 设置为 <code>TRUE</code> ，当仅做两个组的配对 t 检验时，检验结果与前面的等价。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a><span class="fu">with</span>(sleep, <span class="fu">pairwise.t.test</span>(<span class="at">x =</span> extra, <span class="at">g =</span> group, <span class="at">paired =</span> <span class="cn">TRUE</span>))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Pairwise comparisons using paired t tests 
#&gt; 
#&gt; data:  extra and group 
#&gt; 
#&gt;   1     
#&gt; 2 0.0028
#&gt; 
#&gt; P value adjustment method: holm</code></pre>
</div>
</div>
<p>输出结果中，组 1 和组 2 配对 t 检验的 P 值为 0.0028。</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
提示
</div>
</div>
<div class="callout-body-container callout-body">
<p>两个组的配对 t 检验还与变截距的线性混合效应模型等价。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb115-2"><a href="#cb115-2"></a>m <span class="ot">&lt;-</span> <span class="fu">lme</span>(<span class="at">fixed =</span> extra <span class="sc">~</span> group, <span class="at">random =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> ID, <span class="at">data =</span> sleep)</span>
<span id="cb115-3"><a href="#cb115-3"></a><span class="fu">summary</span>(m)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed-effects model fit by REML
#&gt;   Data: sleep 
#&gt;        AIC      BIC    logLik
#&gt;   77.95588 81.51737 -34.97794
#&gt; 
#&gt; Random effects:
#&gt;  Formula: ~1 | ID
#&gt;         (Intercept)  Residual
#&gt; StdDev:      1.6877 0.8697384
#&gt; 
#&gt; Fixed effects:  extra ~ group 
#&gt;             Value Std.Error DF  t-value p-value
#&gt; (Intercept)  0.75 0.6003979  9 1.249172  0.2431
#&gt; group2       1.58 0.3889588  9 4.062127  0.0028
#&gt;  Correlation: 
#&gt;        (Intr)
#&gt; group2 -0.324
#&gt; 
#&gt; Standardized Within-Group Residuals:
#&gt;         Min          Q1         Med          Q3         Max 
#&gt; -1.63372282 -0.34157076  0.03346151  0.31510644  1.83858572 
#&gt; 
#&gt; Number of Observations: 20
#&gt; Number of Groups: 10</code></pre>
</div>
</div>
<p>输出结果中，固定效应部分 <code>group2</code> 意味着相对于第 1 组，第 2 组的增加值，其为 1.58，对应的 t 统计量的值为 4.062127， P 值为 0.0028。调用 <strong>nlme</strong> 包的函数 <code>intervals()</code> 计算固定效应部分 95% 的置信区间。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="fu">intervals</span>(m, <span class="at">which =</span> <span class="st">"fixed"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Approximate 95% confidence intervals
#&gt; 
#&gt;  Fixed effects:
#&gt;                  lower est.    upper
#&gt; (Intercept) -0.6081944 0.75 2.108194
#&gt; group2       0.7001140 1.58 2.459886</code></pre>
</div>
</div>
<p><code>group2</code> 对应的 95% 的置信区间是 <span class="math inline">\((0.7001140, 2.459886)\)</span> 。</p>
</div>
</div>
</section><section id="sec-paired-wilcox-test" class="level3" data-number="19.4.2"><h3 data-number="19.4.2" class="anchored" data-anchor-id="sec-paired-wilcox-test">
<span class="header-section-number">19.4.2</span> 配对 Wilcoxon 检验</h3>
<p>Wilcoxon 检验函数 <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> 设置 <code>paired = TRUE</code> 可以做配对检验，但是仅限于两个组。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="co"># 不支持</span></span>
<span id="cb119-2"><a href="#cb119-2"></a><span class="co"># wilcox.test(weight ~ group, data = PlantGrowth, paired = TRUE)</span></span>
<span id="cb119-3"><a href="#cb119-3"></a><span class="co"># 支持</span></span>
<span id="cb119-4"><a href="#cb119-4"></a><span class="fu">wilcox.test</span>(extra <span class="sc">~</span> group, <span class="at">data =</span> sleep, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
#&gt; compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
#&gt; compute exact p-value with zeroes</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Wilcoxon signed rank test with continuity correction
#&gt; 
#&gt; data:  extra by group
#&gt; V = 0, p-value = 0.009091
#&gt; alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section></section><section id="sec-multiple-comparisons" class="level2" data-number="19.5"><h2 data-number="19.5" class="anchored" data-anchor-id="sec-multiple-comparisons">
<span class="header-section-number">19.5</span> 多重假设检验</h2>
<p>同时检验多个统计假设。</p>
<div id="tbl-pairwise-test" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pairwise-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表格&nbsp;19.6: 多重假设检验
</figcaption><div aria-describedby="tbl-pairwise-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 66%">
</colgroup>
<thead><tr class="header">
<th>样本</th>
<th>R 函数</th>
</tr></thead>
<tbody><tr class="odd">
<td>多样本</td>
<td><ul>
<li>
<code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test()</a></code> 正态总体均值检验</li>
<li>
<code><a href="https://rdrr.io/r/stats/pairwise.prop.test.html">pairwise.prop.test()</a></code> 二项总体比例检验</li>
<li>
<code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test()</a></code> 总体未知均值检验</li>
</ul></td>
</tr></tbody>
</table>
</div>
</figure>
</div>
<section id="多重-t-检验" class="level3" data-number="19.5.1"><h3 data-number="19.5.1" class="anchored" data-anchor-id="多重-t-检验">
<span class="header-section-number">19.5.1</span> 多重 t 检验</h3>
<p>数据集 sleep 仅有两个组，数据集 PlantGrowth 包含三个组，下面以数据集 PlantGrowth 为例，介绍做多个组同时进行两两比较的 t 检验。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="co"># 样本成对的情况</span></span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="fu">with</span>(PlantGrowth, <span class="fu">pairwise.t.test</span>(<span class="at">x =</span> weight, <span class="at">g =</span> group, <span class="at">paired =</span> <span class="cn">TRUE</span>))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Pairwise comparisons using paired t tests 
#&gt; 
#&gt; data:  weight and group 
#&gt; 
#&gt;      ctrl  trt1 
#&gt; trt1 0.346 -    
#&gt; trt2 0.220 0.058
#&gt; 
#&gt; P value adjustment method: holm</code></pre>
</div>
</div>
<p>函数 <code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test()</a></code> 以 P 值给出两两配对比较的结果，trt1 和 ctrl 配对比较，P 值为 0.346，trt2 和 ctrl 配对比较，P 值为 0.220，以此类推。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># 样本非成对的情况</span></span>
<span id="cb125-2"><a href="#cb125-2"></a><span class="fu">with</span>(PlantGrowth, <span class="fu">pairwise.t.test</span>(<span class="at">x =</span> weight, <span class="at">g =</span> group))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Pairwise comparisons using t tests with pooled SD 
#&gt; 
#&gt; data:  weight and group 
#&gt; 
#&gt;      ctrl  trt1 
#&gt; trt1 0.194 -    
#&gt; trt2 0.175 0.013
#&gt; 
#&gt; P value adjustment method: holm</code></pre>
</div>
</div>
</section><section id="sec-pairwise-prop-test" class="level3" data-number="19.5.2"><h3 data-number="19.5.2" class="anchored" data-anchor-id="sec-pairwise-prop-test">
<span class="header-section-number">19.5.2</span> 多重比例检验</h3>
<p>对于离散数据，做两两比例检验，采用函数 <code><a href="https://rdrr.io/r/stats/pairwise.prop.test.html">pairwise.prop.test()</a></code> ，如下示例含有 4 个组。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>smokers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">83</span>, <span class="dv">90</span>, <span class="dv">129</span>, <span class="dv">70</span>)</span>
<span id="cb127-2"><a href="#cb127-2"></a>patients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">86</span>, <span class="dv">93</span>, <span class="dv">136</span>, <span class="dv">82</span>)</span>
<span id="cb127-3"><a href="#cb127-3"></a><span class="fu">pairwise.prop.test</span>(smokers, patients)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in prop.test(x[c(i, j)], n[c(i, j)], ...): Chi-squared approximation
#&gt; may be incorrect

#&gt; Warning in prop.test(x[c(i, j)], n[c(i, j)], ...): Chi-squared approximation
#&gt; may be incorrect

#&gt; Warning in prop.test(x[c(i, j)], n[c(i, j)], ...): Chi-squared approximation
#&gt; may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Pairwise comparisons using Pairwise comparison of proportions 
#&gt; 
#&gt; data:  smokers out of patients 
#&gt; 
#&gt;   1     2     3    
#&gt; 2 1.000 -     -    
#&gt; 3 1.000 1.000 -    
#&gt; 4 0.119 0.093 0.124
#&gt; 
#&gt; P value adjustment method: holm</code></pre>
</div>
</div>
</section><section id="sec-pairwise-wilcoxon-test" class="level3" data-number="19.5.3"><h3 data-number="19.5.3" class="anchored" data-anchor-id="sec-pairwise-wilcoxon-test">
<span class="header-section-number">19.5.3</span> Wilcoxon 检验</h3>
<p>Wilcoxon 检验的是两个总体的均值是否相等。</p>
<p>函数 <code><a href="https://rdrr.io/r/stats/pairwise.wilcox.test.html">pairwise.wilcox.test()</a></code> 做两个及以上组的两两比较检验。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">with</span>(PlantGrowth, <span class="fu">pairwise.wilcox.test</span>(<span class="at">x =</span> weight, <span class="at">g =</span> group))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in wilcox.test.default(xi, xj, paired = paired, ...): cannot compute
#&gt; exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Pairwise comparisons using Wilcoxon rank sum test with continuity correction 
#&gt; 
#&gt; data:  weight and group 
#&gt; 
#&gt;      ctrl  trt1 
#&gt; trt1 0.199 -    
#&gt; trt2 0.126 0.027
#&gt; 
#&gt; P value adjustment method: holm</code></pre>
</div>
</div>
</section><section id="dunn-检验" class="level3" data-number="19.5.4"><h3 data-number="19.5.4" class="anchored" data-anchor-id="dunn-检验">
<span class="header-section-number">19.5.4</span> Dunn 检验</h3>
<p><strong>dunn.test</strong> 包提供函数 <code>dunn.test()</code> 实现 Dunn 检验，将 Kruskal-Wallis 秩和检验用于两两比较。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a><span class="fu">library</span>(dunn.test)</span>
<span id="cb133-2"><a href="#cb133-2"></a><span class="fu">with</span>(PlantGrowth, <span class="fu">dunn.test</span>(<span class="at">x =</span> weight, <span class="at">g =</span> group, <span class="at">method =</span> <span class="st">"holm"</span>, <span class="at">altp =</span> <span class="cn">TRUE</span>))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   Kruskal-Wallis rank sum test
#&gt; 
#&gt; data: weight and group
#&gt; Kruskal-Wallis chi-squared = 7.9882, df = 2, p-value = 0.02
#&gt; 
#&gt; 
#&gt;                          Comparison of weight by group                         
#&gt;                                     (Holm)                                     
#&gt; Col Mean-|
#&gt; Row Mean |       ctrl       trt1
#&gt; ---------+----------------------
#&gt;     trt1 |   1.117725
#&gt;          |     0.2637
#&gt;          |
#&gt;     trt2 |  -1.689289  -2.807015
#&gt;          |     0.1823    0.0150*
#&gt; 
#&gt; alpha = 0.05
#&gt; Reject Ho if p &lt;= alpha</code></pre>
</div>
</div>
</section></section><section id="sec-distribution-test" class="level2" data-number="19.6"><h2 data-number="19.6" class="anchored" data-anchor-id="sec-distribution-test">
<span class="header-section-number">19.6</span> 总体分布的检验</h2>
<p>前面介绍的检验方法都是对总体的某个特征数（均值、方差）进行检验，下面介绍的检验方法是针对分布的性质。比如样本是否来自正态分布，两个样本是否来自同一分布，样本点之间是否相互独立，样本点列是否平稳等。通过检验方法探索样本的分布性质。</p>
<section id="sec-normality-test" class="level3" data-number="19.6.1"><h3 data-number="19.6.1" class="anchored" data-anchor-id="sec-normality-test">
<span class="header-section-number">19.6.1</span> 正态性检验</h3>
<p>什么样的数据是正态的，理论上是清楚的，对统计建模来说，更实际的问题是什么样的数据是够正态的！探索性数据分析是不断提出假设和验证假设的过程。</p>
<blockquote class="blockquote">
<p>Usually (but not always) doing tests of normality reflect a lack of understanding of the power of rank tests, and an assumption of high power for the tests (qq plots don’t always help with that because of their subjectivity). When possible it’s good to choose a robust method. Also, doing pre-testing for normality can affect the type I error of the overall analysis.</p>
<p>— Frank Harrell <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</blockquote>
<p>检验：拒绝原假设和接受原假设的风险，数据本身和理论的正态分布的距离，抛开 P 值</p>
<p>Shapiro 和 Wilk 提出的 W 检验 <span class="citation" data-cites="shapiro1965">(<a href="references.html#ref-shapiro1965" role="doc-biblioref">Shapiro 和 Wilk 1965</a>)</span> ，对应的 R 函数为 <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1"></a><span class="fu">set.seed</span>(<span class="dv">20232023</span>)</span>
<span id="cb135-2"><a href="#cb135-2"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb135-3"><a href="#cb135-3"></a><span class="fu">shapiro.test</span>(x)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  x
#&gt; W = 0.98635, p-value = 0.3954</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The issue really comes down to the fact that the questions: “exactly normal?”, and “normal enough?” are 2 very different questions (with the difference becoming greater with increased sample size) and while the first is the easier to answer, the second is generally the more useful one.</p>
<p>— Greg Snow <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
</blockquote>
<p>EP 检验对多种备择假设有较高的效率，利用样本的特征函数和正态分布的特征函数的差的模的平方产生的一个加权积分得到 EP 检验统计量 <span class="citation" data-cites="Epps1983">(<a href="references.html#ref-Epps1983" role="doc-biblioref">Epps 和 Pulley 1983</a>)</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
提示
</div>
</div>
<div class="callout-body-container callout-body">
<p>样本量 <span class="math inline">\(n \geq 200\)</span> EP 检验统计量 <span class="math inline">\(T_{EP}\)</span> 非常接近 <span class="math inline">\(n = \infty\)</span> 时 <span class="math inline">\(T_{EP}\)</span> 的分位数。</p>
</div>
</div>
<p>设 <span class="math inline">\(x_1, \ldots, x_n\)</span> 是来自正态总体 <span class="math inline">\(\mathcal{N}(\mu,\sigma^2)\)</span> 的样本， EP 检验统计量定义为</p>
<p><span class="math display">\[
T_{EP} = 1 + \frac{n}{\sqrt{3}} + \frac{2}{n}\sum_{i=2}^{n}\sum_{j=1}^{i-1}\exp\big\{ - \frac{(x_j - x_i)^2}{2s^2_{\star}}  \big\} - \sqrt{2} \sum_{i=1}^{n}\exp\big\{- \frac{(x_i - \bar{x})^2}{4s^2_{\star}}  \big\}
\]</span></p>
<p>其中 <span class="math inline">\(\bar{x},s^2_{\star}\)</span> 分别是样本均值和（除以 <span class="math inline">\(n\)</span> 的）样本方差。</p>
</section><section id="sec-ks-test" class="level3" data-number="19.6.2"><h3 data-number="19.6.2" class="anchored" data-anchor-id="sec-ks-test">
<span class="header-section-number">19.6.2</span> 同分布检验</h3>
<p>Lilliefors 检验 <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> 和单样本的 ks 检验的关系</p>
<blockquote class="blockquote">
<p>As to whether you can do a <strong>Lilliefors test</strong> for several groups, that depends entirely on your ability to understand what the underlying question would be (see Adams D 1979).</p>
<p>— Knut M. Wittkowski <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
</blockquote>
<p>Kolmogorov-Smirnov 检验：单样本或两样本的同分布检验 <code><a href="https://rdrr.io/r/stats/ks.test.html">ks.test()</a></code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1"></a><span class="co"># 数据 x 与正态分布比较</span></span>
<span id="cb137-2"><a href="#cb137-2"></a><span class="fu">ks.test</span>(x, <span class="at">y =</span> <span class="st">"pnorm"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test
#&gt; 
#&gt; data:  x
#&gt; D = 0.85897, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: two-sided</code></pre>
</div>
</div>
</section><section id="sec-cor-test" class="level3" data-number="19.6.3"><h3 data-number="19.6.3" class="anchored" data-anchor-id="sec-cor-test">
<span class="header-section-number">19.6.3</span> 相关性检验</h3>
<p>样本的相关性检验 <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code>：Pearson’s 相关系数检验，Kendall’s <span class="math inline">\(\tau\)</span> 检验或者 Spearman’s <span class="math inline">\(\rho\)</span> 检验。基于美国高等法院律师对州法官的评级数据集 USJudgeRatings 介绍各项评分之间的相关性。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a><span class="co"># cor.test(method = "pearson")  # lm(y ~ 1 + x)</span></span>
<span id="cb139-2"><a href="#cb139-2"></a><span class="fu">cor.test</span>(<span class="sc">~</span> CONT <span class="sc">+</span> INTG, <span class="at">data =</span> USJudgeRatings)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Pearson's product-moment correlation
#&gt; 
#&gt; data:  CONT and INTG
#&gt; t = -0.8605, df = 41, p-value = 0.3945
#&gt; alternative hypothesis: true correlation is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -0.4168591  0.1741182
#&gt; sample estimates:
#&gt;        cor 
#&gt; -0.1331909</code></pre>
</div>
</div>
<p>其中，变量 CONT 表示律师与法官的联系次数，INTG 表示司法公正。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a><span class="co"># cor.test(method = "kendall")</span></span>
<span id="cb141-2"><a href="#cb141-2"></a><span class="co"># cor.test(method = "spearman") # lm(rank(y) ~ 1 + rank(x))</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-Box-test" class="level3" data-number="19.6.4"><h3 data-number="19.6.4" class="anchored" data-anchor-id="sec-Box-test">
<span class="header-section-number">19.6.4</span> 独立性检验</h3>
<p>时间序列独立性检验 <code><a href="https://rdrr.io/r/stats/box.test.html">Box.test()</a></code> 计算 Box-Pierce 或 Ljung-Box 检验统计量来检查给定时间序列的独立性假设。</p>
</section><section id="sec-PP-test" class="level3" data-number="19.6.5"><h3 data-number="19.6.5" class="anchored" data-anchor-id="sec-PP-test">
<span class="header-section-number">19.6.5</span> 平稳性检验</h3>
<p>时间序列单位根检验，检验时间序列平稳性 Phillips-Perron 的单位根检验 <code><a href="https://rdrr.io/r/stats/pp.test.html">PP.test()</a></code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a><span class="fu">PP.test</span>(x, <span class="at">lshort =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="sec-multivariate-hypothesis-testing" class="level2" data-number="19.7"><h2 data-number="19.7" class="anchored" data-anchor-id="sec-multivariate-hypothesis-testing">
<span class="header-section-number">19.7</span> 多元分布情形</h2>
<ul>
<li>Hotelling T<sup>2</sup> 检验：总体服从多元正态分布，两样本均值之差的检验。</li>
<li>Mauchly 球形检验：总体服从多元正态分布，单样本协方差矩阵的检验。</li>
</ul>
<section id="sec-hotelling-test" class="level3" data-number="19.7.1"><h3 data-number="19.7.1" class="anchored" data-anchor-id="sec-hotelling-test">
<span class="header-section-number">19.7.1</span> Hotelling T<sup>2</sup> 检验</h3>
<p>Hotelling T<sup>2</sup> 检验是一维情形下两样本 <span class="math inline">\(t\)</span> 检验的多维推广。</p>
</section><section id="sec-mauchly-test" class="level3" data-number="19.7.2"><h3 data-number="19.7.2" class="anchored" data-anchor-id="sec-mauchly-test">
<span class="header-section-number">19.7.2</span> Mauchly 球形检验</h3>
<p>Mauchly 球形检验 <code><a href="https://rdrr.io/r/stats/mauchly.test.html">mauchly.test()</a></code> 检验：Wishart 分布的协方差矩阵是否正比于给定的矩阵。一组样本来自多元正态分布，样本的协方差矩阵是关于样本的随机矩阵，随机矩阵的分布服从 Wishart 分布。</p>
<p>如果 <span class="math inline">\(\bm{x_1}, \bm{x_2}, \cdots, \bm{x_m}\)</span>，<span class="math inline">\(\bm{x_i} \in \mathbb{R}^p\)</span>，<span class="math inline">\(\bm{x_i} \overset{i.i.d}{\sim} \mathrm{MVN}(0,\Sigma)\)</span>，即 <span class="math inline">\(m\)</span> 个样本点都服从均值为 <span class="math inline">\(0\)</span>，协方差矩阵为 <span class="math inline">\(\Sigma\)</span> 的 <span class="math inline">\(p\)</span> 维多元正态分布 <span class="math inline">\(\mathrm{MVN}(0,\Sigma)\)</span>，且样本点之间相互独立。则 <span class="math inline">\(X = \bm{x}^{\top}\bm{x}\)</span> 服从参数为 <span class="math inline">\(\Sigma\)</span> ，自由度为 <span class="math inline">\(m\)</span> 的 Wishart 分布 <span class="math inline">\(W_p(\Sigma, m)\)</span>。概率密度函数如下</p>
<p><span class="math display">\[
f(X) = \frac{1}{2^{\frac{mp}{2}}|\Sigma|^{\frac{m}{2}}\Gamma_{p}(\frac{m}{2})}|X|^{(m-p-1)/2}\exp\{-\frac{1}{2}\mathrm{tr}(\Sigma^{-1}X)\}
\]</span></p>
<p>其中， <span class="math inline">\(\Gamma_p\)</span> 是多元伽马函数，定义如下</p>
<p><span class="math display">\[
\Gamma_p(\frac{m}{2}) = \pi^{p(p-1)/4}\prod_{j=1}^{p}\Gamma(\frac{m}{2} - \frac{j-1}{2})
\]</span></p>
<p>R 语言内置了一个模拟数生成器，可以直接模拟出服从 Wishart 分布 <span class="math inline">\(W_p(\Sigma, m)\)</span> 的样本，<span class="math inline">\(m = \mathrm{df}, \Sigma = \mathrm{Sigma}\)</span>。 R 语言命令如下：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a><span class="fu">rWishart</span>(n, df, Sigma)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>其中，整型参数 <code>n</code> 指定样本量，数值参数 <code>df</code> 指定自由度，正定的 <span class="math inline">\(p \times p\)</span> 矩阵 <code>Sigma</code> 指定 Wishart 分布的矩阵参数。<code><a href="https://rdrr.io/r/stats/rWishart.html">rWishart()</a></code> 返回一个 <span class="math inline">\(p\times p \times n\)</span> 数组 <span class="math inline">\(R\)</span>，其中 <span class="math inline">\(R[,,i]\)</span> 是正定矩阵，是服从 Wishart 分布 <span class="math inline">\(W_p(\Sigma, m)\)</span> 的一个样本点，其中 <span class="math inline">\(m = \mathrm{df}, \Sigma = \mathrm{Sigma}\)</span>。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb144-2"><a href="#cb144-2"></a><span class="co"># 构造 n 个随机矩阵</span></span>
<span id="cb144-3"><a href="#cb144-3"></a>S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">1.2</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb144-4"><a href="#cb144-4"></a><span class="fu">rWishart</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">df =</span> <span class="dv">2</span>, <span class="at">Sigma =</span> S)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; , , 1
#&gt; 
#&gt;          [,1]      [,2]
#&gt; [1,] 3.213745 1.2445391
#&gt; [2,] 1.244539 0.5032642
#&gt; 
#&gt; , , 2
#&gt; 
#&gt;          [,1]     [,2]
#&gt; [1,] 4.443057 3.387850
#&gt; [2,] 3.387850 2.605341
#&gt; 
#&gt; , , 3
#&gt; 
#&gt;          [,1]     [,2]
#&gt; [1,] 3.614911 4.797919
#&gt; [2,] 4.797919 6.846811</code></pre>
</div>
</div>
<p>随机矩阵 <span class="math inline">\(M\)</span> 的期望 <span class="math inline">\(\mathsf{E}(M) = m \times \Sigma\)</span>，随机矩阵 <span class="math inline">\(M\)</span> 中每个元素的方差</p>
<p><span class="math display">\[
\mathsf{Var}(M_{ij}) = m (\Sigma_{ij}^2 + \Sigma_{ii}\Sigma_{jj}), \quad S = \Sigma
\]</span></p>
<p>若 <span class="math inline">\(p = 1\)</span>，即 <span class="math inline">\(\Sigma\)</span> 是一个标量 <span class="math inline">\(\sigma^2\)</span>，Wishart 分布退化为自由度为 <span class="math inline">\(\mathrm{df}\)</span> 的卡方分布 <span class="math inline">\(\chi^2\)</span>，即 <span class="math inline">\(W_1(\sigma^2, m) = \sigma^2\chi_{m}^2\)</span>。下面计算随机矩阵 <span class="math inline">\(M\)</span> 的期望。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb146-2"><a href="#cb146-2"></a>Wish <span class="ot">&lt;-</span> <span class="fu">rWishart</span>(<span class="at">n =</span> <span class="dv">3000</span>, <span class="at">df =</span> <span class="dv">2</span>, <span class="at">Sigma =</span> S)</span>
<span id="cb146-3"><a href="#cb146-3"></a><span class="co"># 计算随机矩阵 M 的期望</span></span>
<span id="cb146-4"><a href="#cb146-4"></a><span class="fu">apply</span>(Wish, <span class="at">MARGIN =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">FUN =</span> mean)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          [,1]     [,2]
#&gt; [1,] 2.375915 1.792558
#&gt; [2,] 1.792558 2.430074</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1"></a><span class="co"># 随机矩阵 M 的期望理论值</span></span>
<span id="cb148-2"><a href="#cb148-2"></a><span class="dv">2</span> <span class="sc">*</span> S</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      [,1] [,2]
#&gt; [1,]  2.4  1.8
#&gt; [2,]  1.8  2.4</code></pre>
</div>
</div>
<p>接着计算随机矩阵 <span class="math inline">\(M\)</span> 的方差。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a><span class="co"># 样本方差</span></span>
<span id="cb150-2"><a href="#cb150-2"></a><span class="fu">apply</span>(Wish, <span class="at">MARGIN =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, var)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          [,1]     [,2]
#&gt; [1,] 5.668746 4.472606
#&gt; [2,] 4.472606 5.729270</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a><span class="co"># 理论方差</span></span>
<span id="cb152-2"><a href="#cb152-2"></a><span class="dv">2</span><span class="sc">*</span>(S<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">tcrossprod</span>(<span class="fu">diag</span>(S)))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      [,1] [,2]
#&gt; [1,] 5.76 4.50
#&gt; [2,] 4.50 5.76</code></pre>
</div>
</div>
</section></section><section id="sec-common-statistical-tests-notes" class="level2" data-number="19.8"><h2 data-number="19.8" class="anchored" data-anchor-id="sec-common-statistical-tests-notes">
<span class="header-section-number">19.8</span> 假设检验的一些注记</h2>
<p>真实数据的情况是复杂多样的，本章按照数据情况对检验方法分类，方便读者根据手头的数据情况，快速从众多的方法中定位最合适的检验方法。依次是单样本检验、两样本检验、多样本检验、计数数据检验、配对样本检验。如果已知符合参数检验的条件，优先考虑参数检验。如果不确定是否符合参数检验的条件，对参数检验和非参数检验方法都适用，非参数检验方法的功效更大，方法更优。在总体分布未知的情况下，无论是对均值检验还是对方差检验，大部分情况下都需要非参数检验方法。</p>
<p>在假设检验理论方面作出贡献的人非常多，自 Karl Pearson 提出卡方统计量、卡方分布和卡方检验以来，陆续涌现出来一批人及载入史册的工作，见下表。不难看出，19 世纪后半叶至20世纪前半叶，假设检验理论经过一个世纪的发展趋于成熟。从假设检验这个细分领域也印证了世界的统计中心从英国逐渐转移到美国，相比而言，中国在这方面的贡献微乎其微。笔者同时也注意到很多检验方法都是以人名命名的，且已经被编写到各类统计软件中。R 语言中有十分丰富的统计检验函数，根据这些函数及其帮助文档可以追溯到检验方法的发明者，再从维基百科中找到学者及其提出的检验方法的详情页，最后，根据学者的出生日期排序整理成表格。</p>
<div id="tbl-statistican" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-statistican-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表格&nbsp;19.7: 对假设检验理论有重要贡献的学者
</figcaption><div aria-describedby="tbl-statistican-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 28%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">姓名</th>
<th>国籍</th>
<th>出生</th>
<th>死亡</th>
<th>寿命</th>
<th>贡献</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Karl_Pearson">K. Pearson</a></td>
<td>英国</td>
<td>1857-03-27</td>
<td>1936-04-27</td>
<td>79</td>
<td>卡方分布、卡方检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Charles_Spearman">C. Spearman</a></td>
<td>英国</td>
<td>1863-09-10</td>
<td>1945-09-17</td>
<td>82</td>
<td>Spearman’s <span class="math inline">\(\rho\)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/William_Sealy_Gosset">W. S. Gosset</a></td>
<td>英国</td>
<td>1876-06-13</td>
<td>1937-10-16</td>
<td>61</td>
<td>t 分布、t 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Ronald_Fisher">R. A. Fisher</a></td>
<td>英国</td>
<td>1890-02-17</td>
<td>1962-07-29</td>
<td>72</td>
<td>F 检验、Fisher 精确检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Frank_Wilcoxon">F. Wilcoxon</a></td>
<td>美国</td>
<td>1892-09-02</td>
<td>1965-11-18</td>
<td>73</td>
<td>Wilcoxon 秩检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Harald_Cram%C3%A9r">H. Cramér</a></td>
<td>瑞士</td>
<td>1893-09-25</td>
<td>1985-10-05</td>
<td>92</td>
<td>Cramér’s V</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Jerzy_Neyman">J. Neyman</a></td>
<td>波兰、美国</td>
<td>1894-04-16</td>
<td>1981-08-05</td>
<td>87</td>
<td>Neyman-Pearson 引理</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Egon_Pearson">E. S. Pearson</a></td>
<td>英国</td>
<td>1895-08-11</td>
<td>1980-06-12</td>
<td>84</td>
<td>Neyman-Pearson 引理</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Harold_Hotelling">H. Hotelling</a></td>
<td>美国</td>
<td>1895-09-29</td>
<td>1973-12-26</td>
<td>78</td>
<td>Hotelling T<sup>2</sup> 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/E._J._G._Pitman">E. J. G. Pitman</a></td>
<td>澳大利亚</td>
<td>1897-10-29</td>
<td>1993-07-21</td>
<td>95</td>
<td>Pitman 估计</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/John_Wishart_(statistician)">J. Wishart</a></td>
<td>英国</td>
<td>1898-11-28</td>
<td>1956-07-14</td>
<td>57</td>
<td>Wishart 分布</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Quinn_McNemar">Q. M. McNemar</a></td>
<td>美国</td>
<td>1900-02-20</td>
<td>1986-07-03</td>
<td>86</td>
<td>McNemar 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Frank_Yates">F. Yates</a></td>
<td>英国</td>
<td>1902-05-12</td>
<td>1994-06-17</td>
<td>92</td>
<td>Yates 矫正</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Abraham_Wald">A. Wald</a></td>
<td>匈牙利</td>
<td>1902-10-31</td>
<td>1950-12-13</td>
<td>48</td>
<td>Wald 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Andrey_Kolmogorov">A. Kolmogorov</a></td>
<td>苏联</td>
<td>1903-04-25</td>
<td>1987-10-20</td>
<td>84</td>
<td>Kolmogorov-Smirnov 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Samuel_S._Wilks">S. S. Wilks</a></td>
<td>美国</td>
<td>1906-06-17</td>
<td>1964-03-07</td>
<td>57</td>
<td>Wilks 检验/似然比检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/John_Mauchly">J. W. Mauchly</a></td>
<td>美国</td>
<td>1907-08-30</td>
<td>1980-01-08</td>
<td>72</td>
<td>Mauchly 球形检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Maurice_Kendall">M. Kendall</a></td>
<td>英国</td>
<td>1907-09-06</td>
<td>1983-03-29</td>
<td>76</td>
<td>Kendall’s <span class="math inline">\(\tau\)</span>
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/William_Gemmell_Cochran">W. G. Cochran</a></td>
<td>英国、美国</td>
<td>1909-07-15</td>
<td>1980-03-29</td>
<td>70</td>
<td>Cochran–Mantel–Haenszel 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/M._S._Bartlett">M. S. Bartlett</a></td>
<td>英国</td>
<td>1910-06-18</td>
<td>2002-01-08</td>
<td>91</td>
<td>Bartlett 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/William_M._Haenszel">W. M. Haenszel</a></td>
<td>美国</td>
<td>1910-06-19</td>
<td>1998-03-13</td>
<td>87</td>
<td>Cochran–Mantel–Haenszel 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Bernard_Lewis_Welch">B. L. Welch</a></td>
<td>英国</td>
<td>1911</td>
<td>1989-12-29</td>
<td>78</td>
<td>Welch t 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Herman_Otto_Hartley">H. O. Hartley</a></td>
<td>德国</td>
<td>1912-04-13</td>
<td>1980-12-30</td>
<td>68</td>
<td>Hartley 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Milton_Friedman">M. Friedman</a></td>
<td>美国</td>
<td>1912-07-31</td>
<td>2006-11-16</td>
<td>94</td>
<td>Friedman 秩和检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/W._Allen_Wallis">W. A. Wallis</a></td>
<td>美国</td>
<td>1912-11-05</td>
<td>1998-10-12</td>
<td>85</td>
<td>Kruskal-Wallis 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Howard_Levene">H. Levene</a></td>
<td>美国</td>
<td>1914-01-17</td>
<td>2003-07-02</td>
<td>89</td>
<td>Levene 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/John_Tukey">J. W. Tukey</a></td>
<td>美国</td>
<td>1915-06-16</td>
<td>2000-07-26</td>
<td>85</td>
<td>Tukey’s HSD 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Olive_Jean_Dunn">O. J. Dunn</a></td>
<td>美国</td>
<td>1915-09-01</td>
<td>2008-01-12</td>
<td>92</td>
<td>Dunn 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Erich_Leo_Lehmann">E. L. Lehmann</a></td>
<td>法国、美国</td>
<td>1917-11-20</td>
<td>2009-09-12</td>
<td>91</td>
<td>Lehmann-Scheffé 定理</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Theodore_Wilbur_Anderson">T. W. Anderson</a></td>
<td>美国</td>
<td>1918-06-05</td>
<td>2016-09-17</td>
<td>98</td>
<td>Anderson–Darling 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Nathan_Mantel">N. Mantel</a></td>
<td>美国</td>
<td>1919-02-16</td>
<td>2002-05-25</td>
<td>83</td>
<td>Cochran–Mantel–Haenszel 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/William_Kruskal">W. Kruskal</a></td>
<td>美国</td>
<td>1919-10-10</td>
<td>2005-04-21</td>
<td>85</td>
<td>Kruskal-Wallis 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/George_E._P._Box">George E. P. Box</a></td>
<td>英国、美国</td>
<td>1919-10-18</td>
<td>2013-03-28</td>
<td>93</td>
<td>Box-Pierce 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/C._R._Rao">C. R. Rao</a></td>
<td>印度、美国</td>
<td>1920-09-10</td>
<td>2023-08-22</td>
<td>102</td>
<td>Score 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Martin_Wilk">M. Wilk</a></td>
<td>加拿大</td>
<td>1922-12-18</td>
<td>2013-02-19</td>
<td>90</td>
<td>Shapiro-Wilk 检验</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/James_Durbin">J. Durbin</a></td>
<td>英国</td>
<td>1923-06-30</td>
<td>2012-06-23</td>
<td>88</td>
<td>Durbin 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Lucien_Le_Cam">L. Le Cam</a></td>
<td>法国</td>
<td>1924-11-18</td>
<td>2000-04-25</td>
<td>75</td>
<td>渐近理论</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Hubert_Lilliefors">H. Lilliefors</a></td>
<td>美国</td>
<td>1928-06-14</td>
<td>2008-02-23</td>
<td>80</td>
<td>Lilliefors 检验</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://en.wikipedia.org/wiki/Samuel_Sanford_Shapiro">S. S. Shapiro</a></td>
<td>美国</td>
<td>1930-07-13</td>
<td>-</td>
<td>93</td>
<td>Shapiro-Wilk 检验</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
注释
</div>
</div>
<div class="callout-body-container callout-body">
<p>笔者仅根据自己搜集了解的材料制作此表，受一定的局限，或有缺漏和主观。20 世纪 60 年代后，假设检验理论开始成熟起来了，所以仅考虑 1930 年以前出生的。此外，学者需具有一定的名气，至少收录在维基百科词条里。</p>
</div>
</div>
<p>其中，最重要的统计学家及其学术传承关系见下 <a href="#fig-testing-statistical-hypothesis" class="quarto-xref">图&nbsp;<span>19.9</span></a> 。</p>
<div class="cell" data-fig-width="6.5" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-testing-statistical-hypothesis" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-testing-statistical-hypothesis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-testing-statistical-hypothesis">flowchart LR
  F_Galton(F. Galton\n 1822-1911) --&gt; K_Pearson(K. Pearson\n 1857-1936)
  K_Pearson --&gt; R_A_Fisher(R. A. Fisher \n 1890-1962)
  R_A_Fisher --&gt; J_Neyman(J. Neyman\n1894-1981)
  R_A_Fisher --&gt; E_S_Pearson(E. S. Pearson \n1895-1980)
  J_Neyman --&gt; E_L_Lehmann(E. L. Lehmann\n1917-2009)
  E_S_Pearson --&gt; A_Wald(A. Wald\n1902-1950)
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-testing-statistical-hypothesis-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.9: 最重要的统计学家及其学术传承关系
</figcaption></figure>
</div>
</div>
</div>
<p>F. Galton 是 K. Pearson 的老师，E. S. Pearson 是 K. Pearson 的儿子。E. L. Lehmann 是 J. Neyman 的学生，J. Neyman 和 E. S. Pearson 一起提出 N-P 引理，是置信区间和假设检验理论的奠基人。假设检验和区间估计、决策理论是紧密相关的，A. Wald 是继 J. Neyman 和 E. S. Pearson 之后，继续开疆拓土的一位统计学家，不幸的是，在一场飞机事故中英年早逝。</p>
<section id="sec-multiple-comparison" class="level3" data-number="19.8.1"><h3 data-number="19.8.1" class="anchored" data-anchor-id="sec-multiple-comparison">
<span class="header-section-number">19.8.1</span> 假设检验和多重比较的关系</h3>
<p>FDR 是 False Discovery Rate 的简称</p>
</section><section id="假设检验和方差分析的关系" class="level3" data-number="19.8.2"><h3 data-number="19.8.2" class="anchored" data-anchor-id="假设检验和方差分析的关系">
<span class="header-section-number">19.8.2</span> 假设检验和方差分析的关系</h3>
<section id="单因素一元方差分析" class="level4" data-number="19.8.2.1"><h4 data-number="19.8.2.1" class="anchored" data-anchor-id="单因素一元方差分析">
<span class="header-section-number">19.8.2.1</span> 单因素一元方差分析</h4>
<p>函数 <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> 可以做单、双因素一元方差分析</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a>fit_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>两两比较，多重比较</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="fu">TukeyHSD</span>(fit_aov)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   Tukey multiple comparisons of means
#&gt;     95% family-wise confidence level
#&gt; 
#&gt; Fit: aov(formula = weight ~ group, data = PlantGrowth)
#&gt; 
#&gt; $group
#&gt;             diff        lwr       upr     p adj
#&gt; trt1-ctrl -0.371 -1.0622161 0.3202161 0.3908711
#&gt; trt2-ctrl  0.494 -0.1972161 1.1852161 0.1979960
#&gt; trt2-trt1  0.865  0.1737839 1.5562161 0.0120064</code></pre>
</div>
</div>
<p>自己实现方差分析</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="co"># 自由度</span></span>
<span id="cb157-2"><a href="#cb157-2"></a>df1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb157-3"><a href="#cb157-3"></a>df2 <span class="ot">&lt;-</span> <span class="dv">27</span></span>
<span id="cb157-4"><a href="#cb157-4"></a><span class="co"># 每组样本量</span></span>
<span id="cb157-5"><a href="#cb157-5"></a>group.size <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb157-6"><a href="#cb157-6"></a><span class="co"># 组间方差</span></span>
<span id="cb157-7"><a href="#cb157-7"></a>sq.between <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">tapply</span>(</span>
<span id="cb157-8"><a href="#cb157-8"></a>  PlantGrowth<span class="sc">$</span>weight, PlantGrowth<span class="sc">$</span>group,</span>
<span id="cb157-9"><a href="#cb157-9"></a>  <span class="cf">function</span>(x) (<span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">mean</span>(PlantGrowth<span class="sc">$</span>weight))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb157-10"><a href="#cb157-10"></a>)) <span class="sc">*</span> group.size</span>
<span id="cb157-11"><a href="#cb157-11"></a></span>
<span id="cb157-12"><a href="#cb157-12"></a>mean.sq.between <span class="ot">&lt;-</span> sq.between <span class="sc">/</span> df1</span>
<span id="cb157-13"><a href="#cb157-13"></a></span>
<span id="cb157-14"><a href="#cb157-14"></a><span class="co"># 组内方差</span></span>
<span id="cb157-15"><a href="#cb157-15"></a>sq.within <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">tapply</span>(</span>
<span id="cb157-16"><a href="#cb157-16"></a>  PlantGrowth<span class="sc">$</span>weight, PlantGrowth<span class="sc">$</span>group,</span>
<span id="cb157-17"><a href="#cb157-17"></a>  <span class="cf">function</span>(x) <span class="fu">sum</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb157-18"><a href="#cb157-18"></a>))</span>
<span id="cb157-19"><a href="#cb157-19"></a></span>
<span id="cb157-20"><a href="#cb157-20"></a>mean.sq.within <span class="ot">&lt;-</span> sq.within <span class="sc">/</span> df2</span>
<span id="cb157-21"><a href="#cb157-21"></a><span class="co"># F 统计量</span></span>
<span id="cb157-22"><a href="#cb157-22"></a>f.value <span class="ot">&lt;-</span> mean.sq.between <span class="sc">/</span> mean.sq.within</span>
<span id="cb157-23"><a href="#cb157-23"></a>f.value</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 4.846088</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a><span class="co"># P 值</span></span>
<span id="cb159-2"><a href="#cb159-2"></a>p.value <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f.value, df1, df2)</span>
<span id="cb159-3"><a href="#cb159-3"></a>p.value</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.01590996</code></pre>
</div>
</div>
<p>从假设检验角度看单因素方差分析，方差分析其实是在比较多个组的均值是否有显著差异。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="fu">oneway.test</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  One-way analysis of means
#&gt; 
#&gt; data:  weight and group
#&gt; F = 4.8461, num df = 2, denom df = 27, p-value = 0.01591</code></pre>
</div>
</div>
<p>方差分析还可以纳入线性模型的框架内</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> group, <span class="at">data =</span> PlantGrowth)</span>
<span id="cb163-2"><a href="#cb163-2"></a><span class="fu">summary</span>(fit)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; lm(formula = weight ~ group, data = PlantGrowth)
#&gt; 
#&gt; Residuals:
#&gt;     Min      1Q  Median      3Q     Max 
#&gt; -1.0710 -0.4180 -0.0060  0.2627  1.3690 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)   5.0320     0.1971  25.527   &lt;2e-16 ***
#&gt; grouptrt1    -0.3710     0.2788  -1.331   0.1944    
#&gt; grouptrt2     0.4940     0.2788   1.772   0.0877 .  
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Residual standard error: 0.6234 on 27 degrees of freedom
#&gt; Multiple R-squared:  0.2641, Adjusted R-squared:  0.2096 
#&gt; F-statistic: 4.846 on 2 and 27 DF,  p-value: 0.01591</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a><span class="fu">anova</span>(fit)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: weight
#&gt;           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
#&gt; group      2  3.7663  1.8832  4.8461 0.01591 *
#&gt; Residuals 27 10.4921  0.3886                  
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>假定各个组来自正态总体，且它们的方差相同，从 F 统计量的值和检验的 P 值看，方差分析 <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> 、假设检验 <code><a href="https://rdrr.io/r/stats/oneway.test.html">oneway.test()</a></code> 和线性模型 <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> 在这里等价了。</p>
</section><section id="双因素一元方差分析" class="level4" data-number="19.8.2.2"><h4 data-number="19.8.2.2" class="anchored" data-anchor-id="双因素一元方差分析">
<span class="header-section-number">19.8.2.2</span> 双因素一元方差分析</h4>
<div class="cell" data-par="true">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a><span class="fu">with</span>(ToothGrowth, <span class="fu">interaction.plot</span>(supp, dose, len))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ToothGrowth-interaction-plot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-ToothGrowth-interaction-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-ToothGrowth-interaction-plot-1.png" class="img-fluid figure-img" width="480">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ToothGrowth-interaction-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.10: OJ 和 VC 的交互作用
</figcaption></figure>
</div>
</div>
</div>
<p>如果 <code>dose = 2</code>， 则 <code>len</code> 与提供的方式 <code>supp</code> 没有关系。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1"></a>fit_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb168-2"><a href="#cb168-2"></a>fit_aov</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Call:
#&gt;    aov(formula = len ~ supp * dose, data = ToothGrowth)
#&gt; 
#&gt; Terms:
#&gt;                      supp      dose supp:dose Residuals
#&gt; Sum of Squares   205.3500 2224.3043   88.9201  933.6349
#&gt; Deg. of Freedom         1         1         1        56
#&gt; 
#&gt; Residual standard error: 4.083142
#&gt; Estimated effects may be unbalanced</code></pre>
</div>
</div>
</section><section id="单因素多元方差分析" class="level4" data-number="19.8.2.3"><h4 data-number="19.8.2.3" class="anchored" data-anchor-id="单因素多元方差分析">
<span class="header-section-number">19.8.2.3</span> 单因素多元方差分析</h4>
<p><code>PlantGrowth</code> 属于一元方差分析，观测变量只有植物干重一个变量。如果推广到多个变量，就是多元方差分析 multivariate analysis of variance 。不同种类的鸢尾花的萼片长度的分布有所不同。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb170-2"><a href="#cb170-2"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb170-3"><a href="#cb170-3"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Species, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb170-4"><a href="#cb170-4"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Greys"</span>) <span class="sc">+</span></span>
<span id="cb170-5"><a href="#cb170-5"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">bandwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb170-6"><a href="#cb170-6"></a>  <span class="fu">theme_ridges</span>(<span class="at">font_size =</span> <span class="dv">12</span>, <span class="at">font_family =</span> <span class="st">"sans"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-iris-ridgeline" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-iris-ridgeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-iris-ridgeline-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iris-ridgeline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.11: 鸢尾花萼片长度的分布
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) <span class="sc">~</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb171-2"><a href="#cb171-2"></a><span class="fu">summary</span>(fit, <span class="at">test =</span> <span class="st">"Wilks"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            Df    Wilks approx F num Df den Df    Pr(&gt;F)    
#&gt; Species     2 0.023439   199.15      8    288 &lt; 2.2e-16 ***
#&gt; Residuals 147                                              
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>P 值小于 0.0.5，说明 iris 数据集三个组的均值向量有显著差异。关于均值向量的检验方法，请看 <code><a href="https://rdrr.io/r/stats/summary.manova.html">?summary.manova</a></code> 。</p>
<p>按 Species 分组统计各个变量的样本均值、样本方差</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a><span class="fu">aggregate</span>(<span class="at">data =</span> iris, <span class="fu">cbind</span>(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) <span class="sc">~</span> Species, mean)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      Species Sepal.Length Sepal.Width Petal.Length Petal.Width
#&gt; 1     setosa        5.006       3.428        1.462       0.246
#&gt; 2 versicolor        5.936       2.770        4.260       1.326
#&gt; 3  virginica        6.588       2.974        5.552       2.026</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a><span class="fu">aggregate</span>(<span class="at">data =</span> iris, <span class="fu">cbind</span>(Sepal.Length, Sepal.Width, Petal.Length, Petal.Width) <span class="sc">~</span> Species, var)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      Species Sepal.Length Sepal.Width Petal.Length Petal.Width
#&gt; 1     setosa    0.1242490  0.14368980   0.03015918  0.01110612
#&gt; 2 versicolor    0.2664327  0.09846939   0.22081633  0.03910612
#&gt; 3  virginica    0.4043429  0.10400408   0.30458776  0.07543265</code></pre>
</div>
</div>
</section></section><section id="sec-test-and-interval" class="level3" data-number="19.8.3"><h3 data-number="19.8.3" class="anchored" data-anchor-id="sec-test-and-interval">
<span class="header-section-number">19.8.3</span> 假设检验与区间估计的关系</h3>
<p>区间估计的意义是解决点估计可靠性问题，它用置信系数解决了对估计结果的信心问题，弥补了点估计的不足。置信系数是最大的置信水平。</p>
<p>Base R 提供的 <code><a href="https://rdrr.io/r/stats/binom.test.html">binom.test()</a></code> 函数可以精确计算置信区间，即所谓的 Clopper-Pearson 区间，而 <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> 函数可近似计算置信区间，即所谓的 Wilson 区间。以单样本的比例检验为例。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1"></a><span class="co"># 近似区间估计</span></span>
<span id="cb177-2"><a href="#cb177-2"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>#&gt; Warning in prop.test(x = 2, n = 10, p = 0.95, conf.level = 0.95, correct =
#&gt; TRUE): Chi-squared approximation may be incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  1-sample proportions test with continuity correction
#&gt; 
#&gt; data:  2 out of 10, null probability 0.95
#&gt; X-squared = 103.16, df = 1, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: true p is not equal to 0.95
#&gt; 95 percent confidence interval:
#&gt;  0.03542694 0.55781858
#&gt; sample estimates:
#&gt;   p 
#&gt; 0.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a><span class="co"># 精确区间估计</span></span>
<span id="cb180-2"><a href="#cb180-2"></a><span class="fu">binom.test</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Exact binomial test
#&gt; 
#&gt; data:  2 and 10
#&gt; number of successes = 2, number of trials = 10, p-value = 1.605e-09
#&gt; alternative hypothesis: true probability of success is not equal to 0.95
#&gt; 95 percent confidence interval:
#&gt;  0.02521073 0.55609546
#&gt; sample estimates:
#&gt; probability of success 
#&gt;                    0.2</code></pre>
</div>
</div>
<p>实际达到的置信度水平随真实的未知参数值和样本量的变化而<strong>剧烈</strong>波动，这意味着这种参数估计方法在实际应用中不可靠、真实场景中参数真值是永远未知的，样本量是可控的，并且是可以变化的。根本原因在于这类分布是离散的，比如这里的二项分布。当样本数据服从离散的分布，置信区间的端点也是离散的。这种缺陷是无法避免的，清晰的置信区间和离散的数据之间存在无法调和的冲突。</p>
</section><section id="常见的统计检验是线性模型" class="level3" data-number="19.8.4"><h3 data-number="19.8.4" class="anchored" data-anchor-id="常见的统计检验是线性模型">
<span class="header-section-number">19.8.4</span> 常见的统计检验是线性模型</h3>
<p>两样本的均值检验：非参数检验方法</p>
<section id="wilcoxon-符号秩检验" class="level4" data-number="19.8.4.1"><h4 data-number="19.8.4.1" class="anchored" data-anchor-id="wilcoxon-符号秩检验">
<span class="header-section-number">19.8.4.1</span> Wilcoxon 符号秩检验</h4>
<p>与 <code><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test()</a></code> 等价的线性模型</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))</span>
<span id="cb182-2"><a href="#cb182-2"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">signed_rank</span>(extra) <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span>
<span id="cb182-3"><a href="#cb182-3"></a><span class="fu">summary</span>(fit)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; lm(formula = signed_rank(extra) ~ group, data = sleep)
#&gt; 
#&gt; Residuals:
#&gt;    Min     1Q Median     3Q    Max 
#&gt; -14.55  -6.55   0.90   6.90  13.95 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  
#&gt; (Intercept)    3.050      2.872   1.062   0.3022  
#&gt; group2         8.300      4.061   2.044   0.0559 .
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Residual standard error: 9.081 on 18 degrees of freedom
#&gt; Multiple R-squared:  0.1884, Adjusted R-squared:  0.1433 
#&gt; F-statistic: 4.177 on 1 and 18 DF,  p-value: 0.05589</code></pre>
</div>
</div>
</section><section id="kruskal-wallis-秩和检验" class="level4" data-number="19.8.4.2"><h4 data-number="19.8.4.2" class="anchored" data-anchor-id="kruskal-wallis-秩和检验">
<span class="header-section-number">19.8.4.2</span> Kruskal-Wallis 秩和检验</h4>
<p>与 <code><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test()</a></code> 等价的线性模型表示。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">rank</span>(extra) <span class="sc">~</span> group, <span class="at">data =</span> sleep)</span>
<span id="cb184-2"><a href="#cb184-2"></a><span class="fu">summary</span>(fit)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; lm(formula = rank(extra) ~ group, data = sleep)
#&gt; 
#&gt; Residuals:
#&gt;    Min     1Q Median     3Q    Max 
#&gt; -8.450 -3.925 -0.500  5.275  8.950 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)    8.050      1.738   4.633 0.000207 ***
#&gt; group2         4.900      2.457   1.994 0.061520 .  
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Residual standard error: 5.495 on 18 degrees of freedom
#&gt; Multiple R-squared:  0.1809, Adjusted R-squared:  0.1354 
#&gt; F-statistic: 3.976 on 1 and 18 DF,  p-value: 0.06152</code></pre>
</div>
</div>
</section></section><section id="sec-industrial-application" class="level3" data-number="19.8.5"><h3 data-number="19.8.5" class="anchored" data-anchor-id="sec-industrial-application">
<span class="header-section-number">19.8.5</span> 假设检验的工业应用</h3>
<p>传统的试验设计为什么不适用于互联网？因为Fisher的实验设计和方差分析，主要针对的是受控对象，比如测试武器、肥料配比、飞机制造等实体的东西。互联网是虚拟经济，实验的对象是人，对平台来说，人的行为是半知半解，更不受控，所以需要成千上万、乃至几十万的样本才能抵消样本内部的随机性。互联网数据的噪声太多、太大了，微小的变化就好像一粒小石子扔进大海里，要获得样本间显著的差异性，需要累积相当的样本量。另一方面，大型的互联网公司，搜索、推荐、广告等业务相对成熟，提升关键指标，拿到好的结果，往往比较困难。成熟的业务几乎不太可能一次实验拿到很好的结果，所以，方向比努力重要，更快地迭代，跑在同行前面，更快地试错（想法），试更多的错（想法），更好地试错（想法），累积更多的经验，做更多地创新，这是 A/B 实验平台的核心价值。</p>
<p>曾经，在学校里，我总想获得一个全局最优解，并且还有这样的情结，到了厂里，发现没人研究全局最优解，大家都在做 A/B 实验优化自己的子业务和方向。有时候这个细分业务方向甚至也就小几万的用户了。 全局最优解和局部最优解，我们不太可能获得全局最优解，一则全局最优解受影响的因素很多，而这些因素变化很快，所以，即使可以获得全局最优解，代价会非常大，那么，怎么办呢？还不如获取局部最优解，研究一个个局部显然比研究全局要简单的多，此外，研究局部的好处是可以快速地随业务迭代。</p>
<p>一个完整的实验周期包含提出问题、设计实验、收集数据、组织数据、统计检验、分析结论、数据解读、数据交流、决策行动、业务价值。这是一个闭环，根据业务中发现的问题，提出解决方法，并设计实验验证。问题有时候就是机会，奋斗的方向，解决问题自然就会带来业务价值。实验又可以按业务问题、数据问题和统计问题划分三个阶段。</p>
<ul>
<li>业务问题：根据目标确定方向，找到有价值的、可以解决的业务问题，再提出合理的统计假设。</li>
<li>数据问题：数据收集、数据组织、数据管理、数据治理，验证数据流的完整性、一致性等。</li>
<li>统计问题：设计实验方案，包括分流、实验周期等，利用假设检验、区间估计和功效分析等统计工具完成显著性分析、可靠性分析，撰写数据分析和评估报告。</li>
</ul></section></section><section id="sec-common-statistical-tests-exercise" class="level2" data-number="19.9"><h2 data-number="19.9" class="anchored" data-anchor-id="sec-common-statistical-tests-exercise">
<span class="header-section-number">19.9</span> 习题</h2>
<ol type="1">
<li><p>分析《红楼梦》的情景描写。参考 2009 年东南大学韦博成教授将两个独立二项总体的等价性检验应用于《红楼梦》前80回与后40回某些文风差异的统计分析 <span class="citation" data-cites="Wei2009">(<a href="references.html#ref-Wei2009" role="doc-biblioref">韦博成 2009</a>)</span>。</p></li>
<li>
<p>根据数据集 chickwts 分析不同喂食方式对小鸡体重的影响。（单因素方差分析）</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chickwts, <span class="fu">aes</span>(<span class="at">x =</span> feed, <span class="at">y =</span> weight)) <span class="sc">+</span></span>
<span id="cb186-2"><a href="#cb186-2"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb186-3"><a href="#cb186-3"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb186-4"><a href="#cb186-4"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-chickwts-i" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-chickwts-i-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-chickwts-i-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chickwts-i-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.12: 不同喂食方式对小鸡的影响
</figcaption></figure>
</div>
</div>
</div>
</li>
<li>
<p>根据数据集 ChickWeight 分析 4 种喂食方式对小鸡体重有影响，每个小鸡本身对喂食方式的接受、吸收程度不一样、它们本身的素质不一样（个体差异），要考察喂食的方式的影响，应该剔除掉个体差异，才是喂食方式的真正影响。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ChickWeight, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> weight, <span class="at">group =</span> Chick, <span class="at">color =</span> Diet)) <span class="sc">+</span></span>
<span id="cb187-2"><a href="#cb187-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb187-4"><a href="#cb187-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Diet) <span class="sc">+</span></span>
<span id="cb187-5"><a href="#cb187-5"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-chickwts-ii" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-chickwts-ii-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="common-statistical-tests_files/figure-html/fig-chickwts-ii-1.png" class="img-fluid figure-img" width="576">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chickwts-ii-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
图&nbsp;19.13: 不同喂食方式对小鸡的影响（续）
</figcaption></figure>
</div>
</div>
</div>
</li>
</ol>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-ansari1960" class="csl-entry" role="listitem">
Ansari, A. R., 和 R. A. Bradley. 1960. <span>《Rank-Sum Tests for Dispersions》</span>. <em>The Annals of Mathematical Statistics</em> 31 (4): 1174–89. <a href="https://doi.org/10.1214/aoms/1177705688">https://doi.org/10.1214/aoms/1177705688</a>.
</div>
<div id="ref-Cohen1994" class="csl-entry" role="listitem">
Cohen, Jacob. 1994. <span>《The Earth Is Round (<span class="math inline">\(p &lt; .05\)</span>)》</span>. <em>American Psychologist</em> 49 (12): 997–1003. <a href="https://doi.org/10.1037/0003-066x.49.12.997">https://doi.org/10.1037/0003-066x.49.12.997</a>.
</div>
<div id="ref-Dobson1983" class="csl-entry" role="listitem">
Dobson, Annette J. 1983. <em>An Introduction to Statistical Modelling</em>. 1st 本. London: Chapman; Hall/CRC. <a href="https://doi.org/10.1007/978-1-4899-3174-0">https://doi.org/10.1007/978-1-4899-3174-0</a>.
</div>
<div id="ref-Epps1983" class="csl-entry" role="listitem">
Epps, T. W., 和 Lawrence B. Pulley. 1983. <span>《A Test for Normality Based on the Empirical Characteristic Function》</span>. <em>Biometrika</em> 70 (3): 723–26. <a href="https://doi.org/10.2307/2336512">https://doi.org/10.2307/2336512</a>.
</div>
<div id="ref-fligner1976" class="csl-entry" role="listitem">
Fligner, Michael A., 和 Timothy J. Killeen. 1976. <span>《Distribution-Free Two-Sample Tests for Scale》</span>. <em>Journal of the American Statistical Association</em> 71 (353): 210–13. <a href="https://doi.org/10.1080/01621459.1976.10481517">https://doi.org/10.1080/01621459.1976.10481517</a>.
</div>
<div id="ref-Heyde2001" class="csl-entry" role="listitem">
Heyde, C. C., E. Seneta, P. Crépel, S. E. Fienberg, 和 J. Gani. 2001. <em>Statisticians of the Centuries</em>. New York, NY: Springer-Verlag. <a href="https://doi.org/10.1007/978-1-4613-0179-0">https://doi.org/10.1007/978-1-4613-0179-0</a>.
</div>
<div id="ref-Hsu1938" class="csl-entry" role="listitem">
HSU, P. L. 1938. <span>《Contribution to the theory of "Student’s" <span class="math inline">\(T\)</span>-test as applied to the problem of two samples》</span>. <em>Statistical Research Memoirs</em> 2: 1–24.
</div>
<div id="ref-HSU1983" class="csl-entry" role="listitem">
———. 1983. <em>Collected Papers</em>. New York, NY: Springer-Verlag.
</div>
<div id="ref-Kim1998" class="csl-entry" role="listitem">
Kim, Seock-Ho, 和 Allan S. Cohen. 1998. <span>《On the Behrens-Fisher Problem: A Review》</span>. <em>Journal of Educational and Behavioral Statistics</em> 23 (4): 356–77. <a href="https://doi.org/10.2307/1165281">https://doi.org/10.2307/1165281</a>.
</div>
<div id="ref-mood1954" class="csl-entry" role="listitem">
Mood, A. M. 1954. <span>《On the Asymptotic Efficiency of Certain Nonparametric Two-Sample Tests》</span>. <em>The Annals of Mathematical Statistics</em> 25 (3): 514–22. <a href="https://doi.org/10.1214/aoms/1177728719">https://doi.org/10.1214/aoms/1177728719</a>.
</div>
<div id="ref-shapiro1965" class="csl-entry" role="listitem">
Shapiro, S. S., 和 M. B. Wilk. 1965. <span>《An analysis of variance test for normality (complete samples)》</span>. <em>Biometrika</em> 52 (3-4): 591–611. <a href="https://doi.org/10.1093/biomet/52.3-4.591">https://doi.org/10.1093/biomet/52.3-4.591</a>.
</div>
<div id="ref-Gosset1908" class="csl-entry" role="listitem">
"Student". 1908. <span>《The probable error of a mean》</span>. <em>Biometrika</em> 6: 1–25.
</div>
<div id="ref-Wei2009" class="csl-entry" role="listitem">
韦博成. 2009. <span>《《红楼梦》前80回与后40回某些文风差异的统计分析（两个独立二项总体等价性检验的一个应用）》</span>. <em>应用概率统计</em> 25 (4): 441–48. <a href="https://doi.org/10.3969/j.issn.1001-4268.2009.04.012">https://doi.org/10.3969/j.issn.1001-4268.2009.04.012</a>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p><a href="https://stat.ethz.ch/pipermail/r-help/2005-April/070508.html" class="uri">https://stat.ethz.ch/pipermail/r-help/2005-April/070508.html</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="https://stat.ethz.ch/pipermail/r-help/2009-May/390164.html" class="uri">https://stat.ethz.ch/pipermail/r-help/2009-May/390164.html</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://personal.utdallas.edu/~herve/Abdi-Lillie2007-pretty.pdf" class="uri">https://personal.utdallas.edu/~herve/Abdi-Lillie2007-pretty.pdf</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://stat.ethz.ch/pipermail/r-help/2004-February/045597.html" class="uri">https://stat.ethz.ch/pipermail/r-help/2004-February/045597.html</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已复制");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已复制");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="XiangyunHuang/data-analysis-in-action" data-repo-id="R_kgDOGTNtPQ" data-category="General" data-category-id="DIC_kwDOGTNtPc4CQjXN" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./documents-office.html" class="pagination-link  aria-label=">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Office 文档</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./regression-and-correlation.html" class="pagination-link" aria-label="<span class='chapter-number'>20</span>&nbsp; <span class='chapter-title'>回归与相关分析</span>">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">回归与相关分析</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/XiangyunHuang/data-analysis-in-action/blob/main/common-statistical-tests.qmd" class="toc-action"><i class="bi bi-github"></i>查看代码</a></li></ul></div></div></div></footer></body></html>