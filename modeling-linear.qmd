# 线性模型 {#sec-linear-models}


<!-- 
从方差分析到线性模型，点出方差分析与线性模型的关系

https://stat.ethz.ch/~meier/teaching/anova

一般线性模型作为周边介绍一下，statmod: Statistical Modeling
https://cran.r-project.org/package=statmod
-->



## 数据说明 {#sec-data-description}


PlantGrowth 数据集最初来自书籍 @Dobson1983 第9页，后来收录在 R 包 **datasets** 中。在两种不同的实验条件下，通过产量（用植物的干重来衡量）比较植物生长情况。首先观察一下收集到的数据集

```{r}
head(PlantGrowth)
str(PlantGrowth)
```


## 数据探索 {#sec-data-explore}


weight 是数值型的向量，group 是因子型的分类变量

```{r}
#| label: fig-plant-growth
#| fig-cap: "在不同实验条件下，植物产量的比较"
#| fig-width: 5
#| fig-height: 4
#| fig-showtext: true

library(ggplot2)
ggplot(data = PlantGrowth, aes(x = group, y = weight)) +
  geom_boxplot() +
  geom_point() +
  theme_classic() +
  labs(x = "组别", y = "植物干重")
```


## 模型结构 {#sec-model-structure}


```{r}
#| echo: false
#| eval: false

# 将模型转为 LaTeX 公式
equatiomatic::extract_eq(lm_plant_growth)
```

$$
\operatorname{weight} = \alpha + \beta_{1}(\operatorname{group}_{\operatorname{trt1}}) + \beta_{2}(\operatorname{group}_{\operatorname{trt2}}) + \epsilon
$$ {#eq-lm-plant-growth}


## 模型拟合 {#sec-model-fit}


```{r}
lm_plant_growth <- lm(weight ~ group, data = PlantGrowth)
```


## 模型输出 {#sec-model-output}

```{r}
summary(lm_plant_growth)
```


## 结果解释 {#sec-explain-result}


## 结果整理 {#sec-tidy-output}

**broom** 包可将线性回归 `lm()` 的输出结果转化为 tibble 类型，再调函数 `knitr::kable()` 将结果进一步整理成 @tbl-lm-plant。

```{r}
#| label: tbl-lm-plant
#| tbl-cap: "线性模型各个参数的估计结果"
#| echo: false

knitr::kable(broom::tidy(lm_plant_growth), align = "lrrrr")
```
